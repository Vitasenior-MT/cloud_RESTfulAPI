{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./app/models/index.js","webpack:///./app/business/index.js","webpack:///./app/business/v1.0.0/utils.js","webpack:///./app/models/seed.js","webpack:///external \"mongoose\"","webpack:///external \"body-parser\"","webpack:///external \"express-routes-versioning\"","webpack:///./app/controllers/v1.0.0/vitabox.js","webpack:///./app/controllers/v1.0.0/user.js","webpack:///./app/controllers/v1.0.0/sensor.js","webpack:///./app/controllers/v1.0.0/record.js","webpack:///./app/controllers/v1.0.0/manage.js","webpack:///./app/controllers/v1.0.0/board.js","webpack:///./app/business/v1.0.0/vitabox.js","webpack:///./app/business/v1.0.0/user.js","webpack:///./app/business/v1.0.0/sensor.js","webpack:///./app/business/v1.0.0/record.js","webpack:///./app/business/v1.0.0/patient.js","webpack:///./app/business/v1.0.0/board.js","webpack:///./app/business/v1.0.0/board_model.js","webpack:///./app/controllers/v1.0.0/board_model.js","webpack:///./app/controllers/index.js","webpack:///./app/router.js","webpack:///external \"path\"","webpack:///external \"express\"","webpack:///external \"os\"","webpack:///external \"jsonwebtoken\"","webpack:///external \"fs\"","webpack:///external \"crypto\"","webpack:///./app/models/mongodb/record.js","webpack:///./app/models/mysql/vitabox.js","webpack:///./app/models/mysql/user.js","webpack:///./app/models/mysql/user_vitabox.js","webpack:///./app/models/mysql/sensor.js","webpack:///./app/models/mysql/patient.js","webpack:///./app/models/mysql/board.js","webpack:///./app/models/mysql/board_model.js","webpack:///external \"sequelize\"","webpack:///external \"dotenv\"","webpack:///external \"cluster\"","webpack:///./server.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","r","value","n","__esModule","object","property","prototype","hasOwnProperty","p","w","s","mongoose","Sequelize","mongo_uri","mysql_uri","operatorsAliases","$eq","Op","eq","$ne","ne","$gte","gte","$gt","gt","$lte","lte","$lt","lt","$not","not","$in","in","$notIn","notIn","$is","is","$like","like","$notLike","notLike","$iLike","iLike","$notILike","notILike","$regexp","regexp","$notRegexp","notRegexp","$iRegexp","iRegexp","$notIRegexp","notIRegexp","$between","between","$notBetween","notBetween","$overlap","overlap","$contains","contains","$contained","contained","$adjacent","adjacent","$strictLeft","strictLeft","$strictRight","strictRight","$noExtendRight","noExtendRight","$noExtendLeft","noExtendLeft","$and","and","$or","or","$any","any","$all","all","$values","values","$col","col","connect","sequelize","logging","db","Boardmodel","Board","Patient","Sensor","UserVitabox","User","Vitabox","Record","keys","forEach","modelName","associate","connection","v1_0_0","boardmodel","board","patient","record","sensor","user","utils","vitabox","__dirname","crypto","fs","jwt","encrypt","to_encrypt","Promise","resolve","reject","element","index","cipher","createCipher","process","env","ALGORITHM","KEY","update","Buffer","from","final","decrypt","to_decrypt","decipher","createDecipher","createToken","obj","client_address","private_key","readFileSync","toString","undefined","Error","payload","id","role","constructor","options","expiresIn","algorithm","subject","sign","err","token","validateToken","public_key","algorithms","verify","findById","then","error","generatePassword","sk","Math","floor","random","deleteAll","raw","query","truncate","remove","testSeed","seed","count","where","admin","encrypted","bulkCreate","email","password","users","create","latitude","longitude","address","registered","active","addUsers","type","board_models","vitabox_id","boardmodel_id","location","boards","transducer","measure","min_acceptable","max_acceptable","min_possible","max_possible","sensors","addSensors","insertMany","datetime","board_id","sensor_id","doc","birthdate","gender","patients","addPatients","require","business","req","res","client","data","status","json","send","message","register","findByEmail","body","params","addUser","result","remoteAddress","list","vitaboxes","find","getSettings","settings","setSettings","delete","flag","sponsor","getUsers","removeUser","user_id","addPatient","getPatients","removePatient","patient_id","addBoard","getBoards","removeBoard","login","changePassword","old_password","new_password","records","invalid","listByPatient","listByBoard","listBySensor","destroyAll","success","testDb","attributes","findOne","current_user","findAll","exclude","getVitaboxes","dataValues","length","_isSponsor","destroy","is_sponsor","through","is_user","since","created_at","_isUser","VitaboxId","include","model","Sensors","BoardSensor","hasUser","test","new_user","to_insert","push","equals","select","exec","encrypted_name","mac_address","getBoardmodel","models","board_model_id","setSensor","hasSensor","addSensor","getSensors","removeSensor","removeSensors","board_model","manage","app","controllers","versioning","post","1.0.0","2.0.0","put","schema","Schema","Number","required","Date","default","now","String","versionKey","DataTypes","define","UUID","defaultValue","UUIDV4","primaryKey","STRING","allowNull","DECIMAL","validate","min","args","msg","max","JSON","notEmpty","BOOLEAN","underscored","belongsToMany","hasMany","unique","scopes","profile","isDecimal","DATEONLY","ENUM","isIn","belongsTo","cluster","config","isMaster","sync","console","log","cpus","fork","on","worker","code","signal","pid","exit","express","path","router","bodyParser","use","urlencoded","extended","next","header","method","headers","authorization","static","port","PORT","listen"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading wasm modules\n \tvar installedWasmModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// object with all compiled WebAssmbly.Modules\n \t__webpack_require__.w = {};\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 40);\n","var mongoose = require('mongoose'),\r\n    Sequelize = require('sequelize');\r\n\r\nvar mongo_uri = \"\", mysql_uri = \"\";\r\n\r\nif (process.env.NODE_ENV===\"production\") {\r\n    mongo_uri = 'mongodb://localhost:27017/myproject';\r\n    mysql_uri = 'mysql://api:123qwe@localhost:3306/node';\r\n}else{\r\n    mongo_uri = 'mongodb://localhost:27017/test';\r\n    mysql_uri = 'mysql://api:123qwe@localhost:3306/test';\r\n}\r\n\r\nconst operatorsAliases = {\r\n    $eq: Sequelize.Op.eq,\r\n    $ne: Sequelize.Op.ne,\r\n    $gte: Sequelize.Op.gte,\r\n    $gt: Sequelize.Op.gt,\r\n    $lte: Sequelize.Op.lte,\r\n    $lt: Sequelize.Op.lt,\r\n    $not: Sequelize.Op.not,\r\n    $in: Sequelize.Op.in,\r\n    $notIn: Sequelize.Op.notIn,\r\n    $is: Sequelize.Op.is,\r\n    $like: Sequelize.Op.like,\r\n    $notLike: Sequelize.Op.notLike,\r\n    $iLike: Sequelize.Op.iLike,\r\n    $notILike: Sequelize.Op.notILike,\r\n    $regexp: Sequelize.Op.regexp,\r\n    $notRegexp: Sequelize.Op.notRegexp,\r\n    $iRegexp: Sequelize.Op.iRegexp,\r\n    $notIRegexp: Sequelize.Op.notIRegexp,\r\n    $between: Sequelize.Op.between,\r\n    $notBetween: Sequelize.Op.notBetween,\r\n    $overlap: Sequelize.Op.overlap,\r\n    $contains: Sequelize.Op.contains,\r\n    $contained: Sequelize.Op.contained,\r\n    $adjacent: Sequelize.Op.adjacent,\r\n    $strictLeft: Sequelize.Op.strictLeft,\r\n    $strictRight: Sequelize.Op.strictRight,\r\n    $noExtendRight: Sequelize.Op.noExtendRight,\r\n    $noExtendLeft: Sequelize.Op.noExtendLeft,\r\n    $and: Sequelize.Op.and,\r\n    $or: Sequelize.Op.or,\r\n    $any: Sequelize.Op.any,\r\n    $all: Sequelize.Op.all,\r\n    $values: Sequelize.Op.values,\r\n    $col: Sequelize.Op.col\r\n};\r\n\r\n// Create a new conntection to MongoDB server\r\nmongoose.connect(mongo_uri);\r\n// Create a new connection to MySQL server\r\nvar sequelize = new Sequelize(mysql_uri, { operatorsAliases: operatorsAliases, logging: false });\r\n\r\nconst db = {\r\n    'Boardmodel': require('./mysql/board_model')(sequelize, Sequelize),\r\n    'Board': require('./mysql/board')(sequelize, Sequelize),\r\n    'Patient': require('./mysql/patient')(sequelize, Sequelize),\r\n    'Sensor': require('./mysql/sensor')(sequelize, Sequelize),\r\n    'UserVitabox': require('./mysql/user_vitabox')(sequelize, Sequelize),\r\n    'User': require('./mysql/user')(sequelize, Sequelize),\r\n    'Vitabox': require('./mysql/vitabox')(sequelize, Sequelize),\r\n\r\n    'Record': require('./mongodb/record')\r\n}\r\n\r\nObject.keys(db).forEach(modelName => {\r\n    if (db[modelName].associate) db[modelName].associate(db);\r\n});\r\n\r\ndb.sequelize = sequelize;\r\ndb.mongoose = mongoose.connection;\r\n\r\nmodule.exports = db;","module.exports.v1_0_0 = {\r\n    'boardmodel':require('./v1.0.0/board_model'),\r\n    'board': require('./v1.0.0/board'),\r\n    'patient':require('./v1.0.0/patient'),\r\n    'record': require('./v1.0.0/record'),\r\n    'sensor':require('./v1.0.0/sensor'),\r\n    'user': require('./v1.0.0/user'),\r\n    'utils': require('./v1.0.0/utils'),\r\n    'vitabox': require('./v1.0.0/vitabox'),\r\n};","var crypto = require(\"crypto\"),\r\n    fs = require(\"fs\"),\r\n    jwt = require('jsonwebtoken'),\r\n    db = require('../../models/index');\r\n\r\nexports.encrypt = function (to_encrypt) {\r\n    return new Promise((resolve, reject) => {\r\n        to_encrypt.forEach((element, index) => {\r\n            let cipher = crypto.createCipher(process.env.ALGORITHM, process.env.KEY);\r\n            return to_encrypt[index] = cipher.update(Buffer.from(element), 'utf8', 'hex') + cipher.final('hex');\r\n        });\r\n        resolve(to_encrypt);\r\n    });\r\n}\r\n\r\nexports.decrypt = function (to_decrypt) {\r\n    let decipher = crypto.createDecipher(process.env.ALGORITHM, process.env.KEY);\r\n    return decipher.update(to_decrypt, 'hex', 'utf8') + decipher.final('utf8');\r\n}\r\n\r\nexports.createToken = function (obj, client_address) {\r\n    return new Promise((resolve, reject) => {\r\n        let private_key = fs.readFileSync(__dirname + '/../../keys/key.pem').toString();\r\n        if (private_key === undefined) reject(new Error(\"error on load private key\"));\r\n\r\n        let payload = {\r\n            id: obj.id,\r\n            role: obj.constructor.name\r\n        };\r\n        let options = {\r\n            expiresIn: \"8h\",\r\n            algorithm: \"RS256\",\r\n            subject: client_address\r\n        };\r\n\r\n        jwt.sign(payload, private_key, options, function (err, token) {\r\n            if (err) reject(err);\r\n            resolve(token);\r\n        });\r\n    });\r\n}\r\n\r\nexports.validateToken = function (token, client_address) {\r\n    return new Promise((resolve, reject) => {\r\n        let public_key = fs.readFileSync(__dirname + '/../../keys/cert.pem').toString();\r\n        if (public_key === undefined) reject(\"error on load public key\");\r\n\r\n        let options = {\r\n            algorithms: [\"RS256\"],\r\n            subject: client_address\r\n        };\r\n\r\n        jwt.verify(token, public_key, options, function (err, payload) {\r\n            if (err) reject(err);\r\n            db[payload.role].findById(payload.id).then(\r\n                obj => resolve(obj),\r\n                error => reject(error)\r\n            );\r\n        });\r\n    });\r\n}\r\n\r\nexports.generatePassword = () => {\r\n    let sk = \"\", i, j, base = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\";\r\n    for (i = 0; i < 10; i++) {\r\n        sk += base[Math.floor(Math.random() * 61)];\r\n    }\r\n    return sk;\r\n}\r\n\r\n\r\n// JUST TO DEVELOPMENT\r\nexports.deleteAll = function () {\r\n    return new Promise((resolve, reject) => {\r\n\r\n        var options = { raw: true };\r\n\r\n        db.sequelize.query('SET FOREIGN_KEY_CHECKS = 0', options).then(() => {\r\n            db.UserVitabox.truncate().then(() => {\r\n                db.User.truncate().then(() => {\r\n                    db.Vitabox.truncate().then(() => {\r\n                        db.Boardmodel.truncate().then(() => {\r\n                            db.Board.truncate().then(() => {\r\n                                db.Patient.truncate().then(() => {\r\n                                    db.Record.remove({}, () => {\r\n                                        db.sequelize.query('SET FOREIGN_KEY_CHECKS = 1', options).then(\r\n                                            () => resolve(),\r\n                                            error => reject(error));\r\n                                    });\r\n                                }, error => reject(error));\r\n                            }, error => reject(error));\r\n                        }, error => reject(error));\r\n                    }, error => reject(error));\r\n                }, error => reject(error));\r\n            }, error => reject(error));\r\n        }, error => reject(error));\r\n    });\r\n}\r\n\r\nexports.testSeed = function () {\r\n    return new Promise((resolve, reject) => {\r\n        require('../../models/seed').testSeed(db).then(\r\n            () => resolve(),\r\n            error => reject(error));\r\n    });\r\n}","var utils = require('../business/v1.0.0/utils');\r\n\r\nmodule.exports.seed = (db) => {\r\n    return new Promise((resolve, reject) => {\r\n\r\n\r\n        db.User.count({ where: { admin: true } }).then(\r\n            count => {\r\n                if (count < 1) {\r\n                    utils.encrypt([\"admin@a.aa\", \"user1@a.aa\", \"user2@a.aa\", \"123qweASD\", \"passvita\", \"Jos Antnio\", \"Manuela Antonieta\"])\r\n                        .then(\r\n                            encrypted => {\r\n\r\n                                db.User.bulkCreate([\r\n                                    { \"email\": encrypted[0], \"admin\": true, \"password\": encrypted[3] },\r\n                                    { \"email\": encrypted[1], \"password\": encrypted[3] },\r\n                                    { \"email\": encrypted[2], \"password\": encrypted[3] }\r\n                                ]).then(\r\n                                    users => db.Vitabox.create({ \"latitude\": \"39.6003075\", \"longitude\": \"-8.3906627\", \"address\": \"Av. Dr. Aurlio Ribeiro 3, Tomar, Portugal\", \"registered\": true, \"active\": true, \"password\": encrypted[4] }).then(\r\n                                        vitabox => vitabox.addUsers([users[1].id, users[2].id]).then(\r\n                                            () => db.Boardmodel.bulkCreate([\r\n                                                { \"name\": \"Zolertia RE-Mote\", \"type\": \"environmental\" },\r\n                                                { \"name\": \"Xiaomi MI Band\", \"type\": \"wearable\" },\r\n                                                { \"name\": \"MySignals\", \"type\": \"non-wearable\" }\r\n                                            ]).then(\r\n                                                board_models => db.Board.bulkCreate([\r\n                                                    { \"vitabox_id\": vitabox.id, \"boardmodel_id\": board_models[0].id, \"location\": \"kitchen\" },\r\n                                                    { \"vitabox_id\": vitabox.id, \"boardmodel_id\": board_models[1].id },\r\n                                                    { \"vitabox_id\": vitabox.id, \"boardmodel_id\": board_models[2].id, \"location\": \"bedroom\" }\r\n                                                ]).then(\r\n                                                    boards => db.Sensor.bulkCreate([\r\n                                                        { \"transducer\": \"dht22\", \"measure\": \"temperature\", \"min_acceptable\": \"10\", \"max_acceptable\": \"25\", \"min_possible\": \"-20\", \"max_possible\": \"50\" },\r\n                                                        { \"transducer\": \"dht22\", \"measure\": \"humidity\", \"min_acceptable\": \"30\", \"max_acceptable\": \"50\", \"min_possible\": \"20\", \"max_possible\": \"60\" },\r\n                                                        { \"transducer\": \"mq-7\", \"measure\": \"carbon_monoxide\", \"min_acceptable\": \"2\", \"max_acceptable\": \"10\", \"min_possible\": \"10\", \"max_possible\": \"500\" }\r\n                                                    ]).then(\r\n                                                        sensors => board_models[0].addSensors([sensors[0].id, sensors[1].id]).then(\r\n                                                            () => db.Record.insertMany([\r\n                                                                { value: \"20\", datetime: \"2018-03-08T09:43:40.000Z\", board_id: boards[0].id, sensor_id: sensors[0].id },\r\n                                                                { value: \"22\", datetime: \"2018-03-08T09:47:28.000Z\", board_id: boards[0].id, sensor_id: sensors[0].id },\r\n                                                                { value: \"19\", datetime: \"2018-03-08T09:53:47.000Z\", board_id: boards[0].id, sensor_id: sensors[0].id }\r\n                                                            ], (error, doc) => {\r\n                                                                if (error) reject(error);\r\n                                                                else db.Patient.bulkCreate([\r\n                                                                    { \"name\": encrypted[5], \"birthdate\": \"1987-02-28\", \"gender\": \"male\" },\r\n                                                                    { \"name\": encrypted[6], \"birthdate\": \"1972-02-28\", \"gender\": \"female\" }\r\n                                                                ]).then(\r\n                                                                    patients => vitabox.addPatients(patients).then(\r\n                                                                        () => resolve(),\r\n                                                                        error => reject(error)),\r\n                                                                    error => reject(error));\r\n                                                            }),\r\n                                                            error => reject(error)),\r\n                                                        error => reject(error)),\r\n                                                    error => reject(error)),\r\n                                                error => reject(error)),\r\n                                            error => reject(error)),\r\n                                        error => reject(error)),\r\n                                    error => reject(error));\r\n                            }, error => reject(error));\r\n                } else resolve();\r\n            }, error => reject(error));\r\n    });\r\n\r\n}\r\n\r\nmodule.exports.testSeed = (db) => {\r\n    return new Promise((resolve, reject) => {\r\n\r\n        utils.encrypt([\"admin@a.aa\", \"123qweASD\"])\r\n            .then(\r\n                encrypted => {\r\n\r\n                    db.User.create({ \"email\": encrypted[0], \"admin\": true, \"password\": encrypted[1] }).then(\r\n                        () => resolve(),\r\n                        error => reject(error));\r\n                }, error => reject(error));\r\n    });\r\n}","module.exports = require(\"mongoose\");","module.exports = require(\"body-parser\");","module.exports = require(\"express-routes-versioning\");","var business = require('../../business/index').v1_0_0;\r\n/**\r\n * @apiDefine box\r\n * \r\n * @apiHeader Accept-Version=\"1.0.0\"\r\n * @apiHeader Content-Type=\"application/json\"\r\n * @apiHeader Authorization=\"< token >\"\r\n * @apiError {string} error error description\r\n */\r\n\r\n/**\r\n * @api {post} /vitabox 01) Create\r\n * @apiGroup Vitabox\r\n * @apiName create\r\n * @apiDescription create a new vitabox.\r\n * @apiVersion 1.0.0\r\n * @apiUse box\r\n * \r\n * @apiPermission admin\r\n * @apiSuccess {string} id created box id\r\n * @apiSuccess {string} password created box serial key\r\n */\r\nexports.create = function (req, res) {\r\n    if (req.client.constructor.name === \"User\" && req.client.admin) {\r\n        business.vitabox.create().then(\r\n            data => res.status(200).json(data),\r\n            error => res.status(500).send(error.message)\r\n        );\r\n    } else {\r\n        res.status(500).send(\"Unauthorized\");\r\n    }\r\n}\r\n\r\n/**\r\n * @api {post} /vitabox/:id/register 02) Register\r\n * @apiGroup Vitabox\r\n * @apiName vitaboxRegister\r\n * @apiDescription register vitabox, the user must be authenticated as \"admin\" and will define the \"sponsor\" account to the vitabox.\r\n * @apiVersion 1.0.0\r\n * @apiUse box\r\n * \r\n * @apiPermission admin\r\n * @apiParam {string} :id vitabox id\r\n * @apiParam {decimal} latitude min: -90, max: 90 (based on google maps coordinates)\r\n * @apiParam {decimal} longitude min: -180, max: 180 (based on google maps coordinates)\r\n * @apiParam {string} address full address with postal code\r\n * @apiParam {string} email sponsor's email\r\n * @apiParamExample {json} Request example to admin:\r\n *     {\r\n *          \"latitude\": \"38.8976763\",\r\n *          \"longitude\": \"-77.0387185\",\r\n *          \"address\": \"1600 Pennsylvania Ave NW, Washington, DC 20500, EUA\",\r\n *          \"email\": \"sponsor@example.com\"\r\n *     }\r\n * @apiSuccess {boolean} result return \"true\" if was sucessfuly registered\r\n */\r\nexports.register = function (req, res) {\r\n    if (req.client.constructor.name === \"User\" && req.client.admin) {\r\n        business.user.findByEmail(req.body.email).then(\r\n            user => {\r\n                business.vitabox.register(req.params.id, req.body).then(\r\n                    vitabox => {\r\n                        business.vitabox.addUser(req.client, vitabox.id, user.id, true).then(\r\n                            () => res.status(200).json({ result: true }),\r\n                            error => res.status(500).send(error.message));\r\n                    },\r\n                    error => res.status(500).send(error.message));\r\n            },\r\n            error => res.status(500).send(error.message));\r\n    } else {\r\n        res.status(500).send(\"Unauthorized\");\r\n    }\r\n}\r\n\r\n/**\r\n * @api {post} /vitabox/:id/connect 03) Request Token\r\n * @apiGroup Vitabox\r\n * @apiName vitaboxLogin\r\n * @apiDescription request for a token to the vitabox\r\n * @apiVersion 1.0.0\r\n * @apiHeader Accept-Version=\"1.0.0\"\r\n * @apiHeader Content-Type=\"application/json\"\r\n * @apiError {string} error error description\r\n * \r\n * @apiParam {string} :id vitabox id\r\n * @apiParam {string} password password defined by sponsor on registration\r\n * @apiSuccess {string} token jwt valid for 8 hours and must be placed at \"Authorization\" header\r\n */\r\nexports.connect = function (req, res) {\r\n    business.vitabox.connect(req.params.id, req.body.password).then(\r\n        data => {\r\n            business.utils.createToken(data, req.connection.remoteAddress).then(\r\n                token => res.status(200).json({ token: token }),\r\n                error => res.status(500).send({ error: error.message }));\r\n        },\r\n        error => res.status(500).send(error.message)\r\n    );\r\n}\r\n\r\n/**\r\n * @api {get} /vitabox 04) List\r\n * @apiGroup Vitabox\r\n * @apiName list\r\n * @apiDescription list all vitaboxes related to the user. \r\n * @apiVersion 1.0.0\r\n * @apiUse box\r\n * \r\n * @apiPermission any user\r\n * @apiSuccess {array} vitaboxes list of vitaboxes\r\n * @apiSuccess {string} id id of each vitabox\r\n * @apiSuccess {decimal} latitude latitude of each vitabox, min: -90, max: 90 (based on google maps coordinates)\r\n * @apiSuccess {decimal} longitude longitude of each vitabox, min: -180, max: 180 (based on google maps coordinates)\r\n * @apiSuccess {string} address full address of each vitabox\r\n * @apiSuccess {boolean} sponsor flag indicating if the requester is sponsor of that vitabox (only if NOT admin)\r\n * @apiSuccess {json} settings configuration's structure, defined by vitabox (only if admin)\r\n * @apiSuccess {boolean} registered flag indicating if the vitabox was already registered (only if admin)\r\n * @apiSuccess {boolean} active flag indicating if the vitabox was already activated (only if admin)\r\n * @apiSuccess {datetime} created_at date of production (only if admin)\r\n * @apiSuccess {datetime} updated_at date of last update (only if admin)\r\n * @apiSuccessExample {json} Response example to common user:\r\n * {\r\n *  \"vitaboxes\": [\r\n *      {\r\n *          \"id\": \"d1d66ccb-e5a0-4bd4-8580-6218f452e580\",\r\n *          \"latitude\": \"38.8976763\",\r\n *          \"longitude\": \"-77.0387185\",\r\n *          \"address\": \"1600 Pennsylvania Ave NW, Washington, DC 20500, EUA\",\r\n *          \"sponsor\": true\r\n *      },\r\n *      {\r\n *          \"id\": \"a6abfa76-68f0-4325-b3ab-6c540a800284\",\r\n *          \"latitude\": \"51.5058372\",\r\n *          \"longitude\": \"-0.1899126\",\r\n *          \"address\": \"Kensington Gardens, London W8 4PX, Reino Unido\",\r\n *          \"sponsor\": false\r\n *      }\r\n *  ]\r\n * }\r\n * @apiSuccessExample {json} Response example to admin:\r\n * {\r\n *  \"vitaboxes\": [\r\n *      {\r\n *          \"id\": \"d1d66ccb-e5a0-4bd4-8580-6218f452e580\",\r\n *          \"latitude\": \"38.8976763\",\r\n *          \"longitude\": \"-77.0387185\",\r\n *          \"settings\":{\r\n *              \"cnfg1\": \"true\",\r\n *              \"cnfg2\": \"12345\",\r\n *              \"cnfg3\": \"some other config\"\r\n *          },\r\n *          \"address\": \"1600 Pennsylvania Ave NW, Washington, DC 20500, EUA\",\r\n *          \"registered\": false,\r\n *          \"active\": false,\r\n *          \"created_at\": \"2018-02-22T11:57:53.000Z\",\r\n *          \"updated_at\": \"2018-02-22T11:57:53.000Z\"\r\n *      }\r\n *      {\r\n *          \"id\": \"d1d66ccb-e5a0-4bd4-8580-6218f452e580\",\r\n *          \"latitude\": \"51.5058372\",\r\n *          \"longitude\": \"-0.1899126\",\r\n *          \"settings\":{\r\n *              \"cnfg1\": \"true\",\r\n *              \"cnfg2\": \"12345\",\r\n *              \"cnfg3\": \"some other config\"\r\n *          },\r\n *          \"address\": \"Kensington Gardens, London W8 4PX, Reino Unido\",\r\n *          \"registered\": false,\r\n *          \"active\": false,\r\n *          \"created_at\": \"2018-02-22T11:57:53.000Z\",\r\n *          \"updated_at\": \"2018-02-22T11:57:53.000Z\"\r\n *      }\r\n *  ]\r\n * }\r\n */\r\nexports.list = function (req, res) {\r\n    if (req.client.constructor.name === \"User\") {\r\n        business.vitabox.list(req.client).then(\r\n            data => res.status(200).json({ vitaboxes: data }),\r\n            error => res.status(500).send(error.message)\r\n        );\r\n    } else {\r\n        res.status(500).send(\"Unauthorized\");\r\n    }\r\n}\r\n\r\n/**\r\n * @api {get} /vitabox/:id 05) Find\r\n * @apiGroup Vitabox\r\n * @apiName find\r\n * @apiDescription find a specific vitabox if the requester is related to it.\r\n * @apiVersion 1.0.0\r\n * @apiUse box\r\n * \r\n * @apiPermission user\r\n * @apiParam {string} :id vitabox unique ID\r\n * @apiSuccess {string} id vitabox unique ID\r\n * @apiSuccess {decimal} latitude vitabox latitude, min: -90, max: 90 (based on google maps coordinates)\r\n * @apiSuccess {decimal} longitude vitabox longitude, min: -180, max: 180 (based on google maps coordinates)\r\n * @apiSuccess {string} address vitabox full address \r\n * @apiSuccess {boolean} sponsor flag indicating if the requester is sponsor of that vitabox (only if NOT admin)\r\n * @apiSuccess {json} settings configuration's structure, defined by vitabox (only if admin)\r\n * @apiSuccess {boolean} registered flag indicating if the vitabox was already registered (only if admin)\r\n * @apiSuccess {boolean} active flag indicating if the vitabox was already activated (only if admin)\r\n * @apiSuccess {datetime} created_at date of production (only if admin)\r\n * @apiSuccess {datetime} updated_at date of last update (only if admin)\r\n * @apiSuccessExample {json} Response example to common user:\r\n * {\r\n *  \"vitabox\": {\r\n *      \"id\": \"d1d66ccb-e5a0-4bd4-8580-6218f452e580\",\r\n *      \"latitude\": \"38.8976763\",\r\n *      \"longitude\": \"-77.0387185\",\r\n *      \"address\": \"1600 Pennsylvania Ave NW, Washington, DC 20500, EUA\",\r\n *      \"sponsor\": false\r\n *  }\r\n * }\r\n * @apiSuccessExample {json} Response example to admin:\r\n * {\r\n *  \"vitabox\": {\r\n *      \"id\": \"d1d66ccb-e5a0-4bd4-8580-6218f452e580\",\r\n *      \"latitude\": \"38.8976763\",\r\n *      \"longitude\": \"-77.0387185\",\r\n *      \"settings\":{\r\n *          \"cnfg1\": \"true\",\r\n *          \"cnfg2\": \"12345\",\r\n *          \"cnfg3\": \"some other config\"\r\n *      },\r\n *      \"address\": \"1600 Pennsylvania Ave NW, Washington, DC 20500, EUA\",\r\n *      \"created_at\": \"2018-02-19T11:38:32.000Z\",\r\n *      \"updated_at\": \"2018-02-23T16:12:47.000Z\"\r\n *  }\r\n * }\r\n */\r\nexports.find = function (req, res) {\r\n    if (req.client.constructor.name === \"User\") {\r\n        business.vitabox.find(req.client, req.params.id).then(\r\n            data => res.status(200).json({ vitabox: data }),\r\n            error => res.status(500).send(error.message)\r\n        );\r\n    } else {\r\n        res.status(500).send(\"Unauthorized\");\r\n    }\r\n}\r\n\r\n/**\r\n * @api {get} /settings/vitabox 06) Get Settings\r\n * @apiGroup Vitabox\r\n * @apiName getSettings\r\n * @apiDescription returns the vitabox settings\r\n * @apiVersion 1.0.0\r\n * @apiUse box\r\n * \r\n * @apiPermission vitabox\r\n * @apiSuccess {json} settings configuration's structure, defined by vitabox\r\n * @apiSuccessExample {json} Response example:\r\n * {\r\n *      \"settings\":{\r\n *          \"cnfg1\": \"true\",\r\n *          \"cnfg2\": \"12345\",\r\n *          \"cnfg3\": \"some other config\"\r\n *      }\r\n * }\r\n */\r\nexports.getSettings = function (req, res) {\r\n    if (req.client.constructor.name === \"Vitabox\") {\r\n        res.status(200).json({ settings: req.client.settings })\r\n    } else {\r\n        res.status(500).send(\"Unauthorized\");\r\n    }\r\n}\r\n\r\n/**\r\n * @api {put} /settings/vitabox 07) Set Settings\r\n * @apiGroup Vitabox\r\n * @apiName setSettings\r\n * @apiDescription update vitabox settings\r\n * @apiVersion 1.0.0\r\n * @apiUse box\r\n * \r\n * @apiPermission vitabox\r\n * @apiParam {json} settings configuration's structure to be updated\r\n * @apiParamExample {json} Response example:\r\n * {\r\n *      \"settings\":{\r\n *          \"cnfg1\": \"true\",\r\n *          \"cnfg2\": \"12345\",\r\n *          \"cnfg3\": \"some other config\"\r\n *      }\r\n * }\r\n * @apiSuccess {boolean} result return true if was sucessfuly updated\r\n */\r\nexports.setSettings = function (req, res) {\r\n    if (req.client.constructor.name === \"Vitabox\") {\r\n        req.client.update({ settings: req.body.settings }).then(\r\n            () => res.status(200).json({ result: true }),\r\n            error => res.status(500).send(error.message));\r\n    } else {\r\n        res.status(500).send(\"Unauthorized\");\r\n    }\r\n}\r\n\r\n/**\r\n * @api {put} /vitabox/:id 08) Update\r\n * @apiGroup Vitabox\r\n * @apiName update\r\n * @apiDescription update a specific vitabox if the requester is sponsor of it.\r\n * @apiVersion 1.0.0\r\n * @apiUse box\r\n * \r\n * @apiPermission vitabox sponsor\r\n * @apiParam {string} :id vitabox unique ID\r\n * @apiParam {decimal} latitude min: -90, max: 90 (based on google maps coordinates)\r\n * @apiParam {decimal} longitude min: -180, max: 180 (based on google maps coordinates)\r\n * @apiParam {string} address full address with postal code\r\n * @apiParam {json} settings configuration's structure (only if admin)\r\n * @apiParamExample {json} Request example to common user:\r\n *     {\r\n *          \"latitude\": \"38.8976763\",\r\n *          \"longitude\": \"-77.0387185\",\r\n *          \"address\": \"1600 Pennsylvania Ave NW, Washington, DC 20500, EUA\"\r\n *     }\r\n * @apiParamExample {json} Request example to admin:\r\n *     {\r\n *          \"latitude\": \"38.8976763\",\r\n *          \"longitude\": \"-77.0387185\",\r\n *          \"address\": \"1600 Pennsylvania Ave NW, Washington, DC 20500, EUA\",\r\n *          \"settings\":{\r\n *              \"cnfg1\": \"true\",\r\n *              \"cnfg2\": \"12345\",\r\n *              \"cnfg3\": \"some other config\"\r\n *          }\r\n *     }\r\n * @apiSuccess {boolean} result return true if was sucessfuly updated\r\n */\r\nexports.update = function (req, res) {\r\n    if (req.client.constructor.name === \"User\") {\r\n        business.vitabox.update(req.client, req.params.id, req.body).then(\r\n            () => res.status(200).json({ result: true }),\r\n            error => res.status(500).send(error.message)\r\n        );\r\n    } else {\r\n        res.status(500).send(\"Unauthorized\");\r\n    }\r\n}\r\n\r\n/**\r\n * @api {delete} /vitabox/:id 09) Delete\r\n * @apiGroup Vitabox\r\n * @apiName delete\r\n * @apiDescription list all users related with the vitabox if the requester is related too.\r\n * @apiVersion 1.0.0\r\n * @apiUse box\r\n * \r\n * @apiPermission vitabox sponsor\r\n * @apiParam {string} :id vitabox unique ID\r\n * @apiSuccess {boolean} result return true if was sucessfuly removed\r\n */\r\nexports.delete = function (req, res) {\r\n    if (req.client.constructor.name === \"User\") {\r\n        business.vitabox.delete(req.client, req.params.id).then(\r\n            () => res.status(200).json({ result: true }),\r\n            error => res.status(500).send(error.message)\r\n        );\r\n    } else {\r\n        res.status(500).send(\"Unauthorized\");\r\n    }\r\n}\r\n\r\n/**\r\n * @api {post} /vitabox/:id/user 10) Add User\r\n * @apiGroup Vitabox\r\n * @apiName addUser\r\n * @apiDescription add user to a specific vitabox if the requester is sponsor of it.\r\n * @apiVersion 1.0.0\r\n * @apiUse box\r\n * \r\n * @apiPermission vitabox sponsor\r\n * @apiParam {string} :id vitabox unique ID\r\n * @apiParam {string} email email of the user to add\r\n * @apiParamExample {json} Request example:\r\n *     {\r\n *          \"email\": \"user-example@some.thing\"\r\n *     }\r\n * @apiSuccess {boolean} result return true if was sucessfuly added\r\n */\r\nexports.addUser = function (req, res) {\r\n    if (req.client.constructor.name === \"User\") {\r\n        let flag = req.body.sponsor ? true : false;\r\n        business.user.findByEmail(req.body.email).then(\r\n            user => business.vitabox.addUser(req.client, req.params.id, user.id, flag).then(\r\n                () => res.status(200).json({ result: true }),\r\n                error => res.status(500).send(error.message)),\r\n            error => res.status(500).send(error.message));\r\n    } else {\r\n        res.status(500).send(\"Unauthorized\");\r\n    }\r\n}\r\n\r\n/**\r\n * @api {get} /vitabox/:id/user 11) Get Users\r\n * @apiGroup Vitabox\r\n * @apiName getUsers\r\n * @apiDescription get users of specific vitabox if the requester is related to it.\r\n * @apiVersion 1.0.0\r\n * @apiUse box\r\n * \r\n * @apiPermission vitabox user\r\n * @apiParam {string} :id vitabox unique ID\r\n * @apiSuccess {array} users vitabox users list\r\n * @apiSuccess {string} id id of each user\r\n * @apiSuccess {string} email email of each user\r\n * @apiSuccess {datetime} since relationship date with the vitabox\r\n * @apiSuccess {boolean} sponsor flag indicating if the user is sponsor of the vitabox\r\n * @apiSuccessExample {json} Response example:\r\n * {\r\n *  \"users\": [\r\n *      {\r\n *          \"id\": \"585402ef-68dd-44a4-a44b-04152e659d11\",\r\n *          \"email\": \"donaldtrump@usa.com\",\r\n *          \"since\": \"2018-02-19T14:41:13.000Z\",\r\n *          \"sponsor\": false\r\n *      },\r\n *      {\r\n *          \"id\": \"78007a69-baa2-4b24-b936-234883811b6a\",\r\n *          \"email\": \"queenelizabeth@majesty.uk\",\r\n *          \"since\": \"2018-02-19T14:40:14.000Z\",\r\n *          \"sponsor\": true\r\n *      }\r\n *  ]\r\n * }\r\n */\r\nexports.getUsers = function (req, res) {\r\n    business.vitabox.getUsers(req.client.constructor.name === \"User\", req.client, req.params.id).then(\r\n        data => res.status(200).json({ users: data }),\r\n        error => res.status(500).send(error.message)\r\n    );\r\n}\r\n\r\n/**\r\n * @api {delete} /vitabox/:id/user 12) Remove User\r\n * @apiGroup Vitabox\r\n * @apiName removeUser\r\n * @apiDescription remove user from a specific vitabox if the requester is sponsor of it.\r\n * @apiVersion 1.0.0\r\n * @apiUse box\r\n * \r\n * @apiPermission vitabox sponsor\r\n * @apiParam {string} :id vitabox unique ID\r\n * @apiParam {string} user_id user unique ID\r\n * @apiParamExample {json} Request example:\r\n *     {\r\n *          \"user_id\": \"9f846ccb-e5a0-4bd4-94ac-621847dfa780\"\r\n *     }\r\n * @apiSuccess {boolean} result return true if was sucessfuly removed\r\n */\r\nexports.removeUser = function (req, res) {\r\n    if (req.client.constructor.name === \"User\") {\r\n        business.vitabox.removeUser(req.client, req.params.id, req.body.user_id).then(\r\n            () => res.status(200).json({ result: true }),\r\n            error => res.status(500).send(error.message)\r\n        );\r\n    } else {\r\n        res.status(500).send(\"Unauthorized\");\r\n    }\r\n}\r\n\r\n/**\r\n * @api {post} /vitabox/:id/patient 13) Add Patient\r\n * @apiGroup Vitabox\r\n * @apiName addPatient\r\n * @apiDescription add patient to a specific vitabox if the requester is sponsor of it.\r\n * @apiVersion 1.0.0\r\n * @apiUse box\r\n * \r\n * @apiPermission vitabox sponsor\r\n * @apiParam {string} :id vitabox unique ID\r\n * @apiParam {string} name patient name\r\n * @apiParam {date} birthdate patient birthdate (date only)\r\n * @apiParam {string} gender patient gender (must be 'male', 'female' or 'undefined')\r\n * @apiParamExample {json} Request example:\r\n *     {\r\n *          \"name\": \"Jos Antnio\",\r\n *          \"birthdate\": \"1987-02-28\",\r\n *          \"gender\": \"male\"\r\n *     }\r\n * @apiSuccess {boolean} result return true if was sucessfuly added\r\n */\r\nexports.addPatient = function (req, res) {\r\n    if (req.client.constructor.name === \"User\") {\r\n        business.patient.create(req.body).then(\r\n            patient => business.vitabox.addPatient(req.client, req.params.id, patient.id).then(\r\n                () => res.status(200).json({ result: true }),\r\n                error => res.status(500).send(error.message)),\r\n            error => res.status(500).send(error.message)\r\n        );\r\n    } else {\r\n        res.status(500).send(\"Unauthorized\");\r\n    }\r\n}\r\n\r\n/**\r\n * @api {get} /vitabox/:id/patient 14) Get Patients\r\n * @apiGroup Vitabox\r\n * @apiName getPatients\r\n * @apiDescription get patients of specific vitabox if the requester is related to it.\r\n * @apiVersion 1.0.0\r\n * @apiUse box\r\n * \r\n * @apiPermission vitabox user\r\n * @apiParam {string} :id vitabox unique ID\r\n * @apiSuccess {array} patients vitabox patients list\r\n * @apiSuccess {string} id id of each patient\r\n * @apiSuccess {date} birthdate patient birthdate (date only)\r\n * @apiSuccess {string} name name of each patient\r\n * @apiSuccess {string} gender patient gender (must be 'male', 'female' or 'undefined')\r\n * @apiSuccess {datetime} since relationship date with the vitabox \r\n * @apiSuccessExample {json} Response example:\r\n * {\r\n *  \"patients\": [\r\n *      {\r\n *          \"id\": \"a77ea0fe-5e34-4189-9702-95cb69b4cd1d\",\r\n *          \"birthdate\": \"1987-02-28\",\r\n *          \"name\": \"Jos Antnio\",\r\n *          \"gender\": \"male\",\r\n *          \"since\": \"2018-02-19T14:55:59.000Z\"\r\n *      }\r\n *  ]\r\n * }\r\n */\r\nexports.getPatients = function (req, res) {\r\n    business.vitabox.getPatients(req.client.constructor.name === \"User\", req.client, req.params.id).then(\r\n        data => res.status(200).json({ patients: data }),\r\n        error => res.status(500).send(error.message)\r\n    );\r\n}\r\n\r\n/**\r\n * @api {delete} /vitabox/:id/patient 15) Remove Patient\r\n * @apiGroup Vitabox\r\n * @apiName removePatient\r\n * @apiDescription remove patient from a specific vitabox if the requester is sponsor of it.\r\n * @apiVersion 1.0.0\r\n * @apiUse box\r\n * \r\n * @apiPermission vitabox sponsor\r\n * @apiParam {string} :id vitabox unique ID\r\n * @apiParam {string} patient_id patient unique ID\r\n * @apiParamExample {json} Request example:\r\n *     {\r\n *          \"patient_id\": \"9f846ccb-e5a0-4bd4-94ac-621847dfa780\"\r\n *     }\r\n * \r\n * @apiSuccess {boolean} result return true if was sucessfuly removed\r\n */\r\nexports.removePatient = function (req, res) {\r\n    if (req.client.constructor.name === \"User\") {\r\n        business.vitabox.removePatient(req.client, req.params.id, req.body.patient_id).then(\r\n            () => res.status(200).json({ result: true }),\r\n            error => res.status(500).send(error.message)\r\n        );\r\n    } else {\r\n        res.status(500).send(\"Unauthorized\");\r\n    }\r\n}\r\n\r\n/**\r\n * @api {post} /vitabox/:id/board 16) Add Board\r\n * @apiGroup Vitabox\r\n * @apiName addBoard\r\n * @apiDescription add board to a specific vitabox if the requester is sponsor of it.\r\n * @apiVersion 1.0.0\r\n * @apiUse box\r\n * \r\n * @apiPermission vitabox sponsor\r\n * @apiParam {string} :id vitabox unique ID\r\n * @apiParam {string} location place where the board is located, if wearable is null\r\n * @apiParam {string} model model id of the board\r\n * @apiParam {string} mac_address board MAC address\r\n * @apiParamExample {json} Request example:\r\n *     {\r\n *          \"location\": \"kitchen\",\r\n *          \"model\":\"5d93585b-f511-4fa8-b69e-692c2474d5e8\",\r\n *          \"mac_address\": \"00:19:B9:FB:E2:58\"\r\n *     }\r\n * @apiSuccess {boolean} result return true if was sucessfuly added\r\n */\r\nexports.addBoard = function (req, res) {\r\n    if (req.client.constructor.name === \"User\") {\r\n        business.board.create(req.body).then(\r\n            board => business.vitabox.addBoard(req.client, req.params.id, board.id).then(\r\n                () => res.status(200).json({ result: true }),\r\n                error => res.status(500).send(error.message)),\r\n            error => res.status(500).send(error.message)\r\n        );\r\n    } else {\r\n        res.status(500).send(\"Unauthorized\");\r\n    }\r\n}\r\n\r\n/**\r\n * @api {get} /vitabox/:id/board 17) Get Boards\r\n * @apiGroup Vitabox\r\n * @apiName getBoards\r\n * @apiDescription get boards of specific vitabox if the requester is related to it.\r\n * @apiVersion 1.0.0\r\n * @apiUse box\r\n * \r\n * @apiPermission vitabox user\r\n * @apiParam {string} :id vitabox unique ID\r\n * @apiSuccess {array} boards vitabox boards list\r\n * @apiSuccess {string} id id of each board\r\n * @apiSuccess {string} location place where the board is located (house division)\r\n * @apiSuccess {string} mac_address board MAC address\r\n * @apiSuccess {datetime} created_at register day to the vitabox\r\n * @apiSuccess {json} BoardModel model of each board, contains an id, type and name\r\n * @apiSuccessExample {json} Response example:\r\n * {\r\n *  \"boards\": [\r\n *      {\r\n *          \"id\": \"983227e9-e1dc-410e-829d-1636627397ba\",\r\n *          \"location\": \"kitchen\",\r\n *          \"mac_address\": \"00:19:B9:FB:E2:58\",\r\n *          \"created_at\": \"2018-02-22T15:25:50.000Z\",\r\n *          \"BoardModel\": {\r\n *              \"id\": \"1920ed05-0a24-4611-b822-5da7a58ba8bb\",\r\n *              \"type\": \"environmental\",\r\n *              \"name\": \"Zolertia RE-Mote\",\r\n *              \"Sensors\": [\r\n *                  {\r\n *                      \"id\": \"2a2f5839-6b68-41a6-ada7-f9cd4c66cf38\",\r\n *                      \"transducer\": \"dht22\",\r\n *                      \"measure\": \"temperature\",\r\n *                      \"min_acceptable\": \"10.00000\",\r\n *                      \"max_acceptable\": \"25.00000\",\r\n *                      \"min_possible\": \"-20.00000\",\r\n *                      \"max_possible\": \"50.00000\"\r\n *                  }\r\n *              ]\r\n *          }\r\n *      }\r\n *  ]\r\n * }\r\n */\r\nexports.getBoards = function (req, res) {\r\n    business.vitabox.getBoards(req.client.constructor.name === \"User\", req.client, req.params.id).then(\r\n        data => res.status(200).json({ boards: data }),\r\n        error => res.status(500).send(error.message)\r\n    );\r\n}\r\n\r\n/**\r\n * @api {delete} /vitabox/:id/patient 18) Remove Board\r\n * @apiGroup Vitabox\r\n * @apiName removeBoard\r\n * @apiDescription remove board from a specific vitabox if the requester is sponsor of it.\r\n * @apiVersion 1.0.0\r\n * @apiUse box\r\n * \r\n * @apiPermission vitabox sponsor\r\n * @apiParam {string} :id vitabox unique ID\r\n * @apiParam {string} board_id board unique ID\r\n * @apiParamExample {json} Request example:\r\n *     {\r\n *          \"board_id\": \"9f846ccb-e5a0-4bd4-94ac-621847dfa780\"\r\n *     }\r\n * \r\n * @apiSuccess {boolean} result return true if was sucessfuly removed\r\n */\r\nexports.removeBoard = function (req, res) {\r\n    if (req.client.constructor.name === \"User\") {\r\n        business.vitabox.removeBoard(req.client, req.params.id, req.body.board_id).then(\r\n            () => res.status(200).json({ result: true }),\r\n            error => res.status(500).send(error.message)\r\n        );\r\n    } else {\r\n        res.status(500).send(\"Unauthorized\");\r\n    }\r\n}","var business = require('../../business/index').v1_0_0;\r\n/**\r\n * @apiDefine auth\r\n * \r\n * @apiHeader Accept-Version=\"1.0.0\"\r\n * @apiHeader Content-Type=\"application/json\"\r\n * @apiError {string} error error description\r\n */\r\n\r\n/**\r\n * @api {post} /register 01) Register user\r\n * @apiGroup Authentication\r\n * @apiName userRegister\r\n * @apiVersion 1.0.0\r\n * @apiUse auth\r\n * @apiParam {string} email valid email\r\n * @apiParam {string} password must have at least one uppercase letter, one lowercase, one digit and a minimum 8 characters\r\n * @apiSuccess {string} token jwt valid for 8 hours and must be placed at \"Authorization\" header\r\n */\r\nexports.register = function (req, res) {\r\n    business.user.register(req.body.email, req.body.password).then(\r\n        user => {\r\n            business.utils.createToken(user, req.connection.remoteAddress).then(\r\n                token => res.status(200).json({ token: token, user: user.id }),\r\n                error => res.status(500).send(error.message));\r\n        },\r\n        error => res.status(500).send(error.message)\r\n    );\r\n}\r\n\r\n/**\r\n * @api {post} /login 02) Login user\r\n * @apiGroup Authentication\r\n * @apiName userLogin\r\n * @apiVersion 1.0.0\r\n * @apiUse auth\r\n * @apiParam {string} email valid email\r\n * @apiParam {string} password must have at least one uppercase letter, one lowercase, one digit and a minimum 8 characters\r\n * @apiSuccess {string} token jwt valid for 8 hours and must be placed at \"Authorization\" header\r\n */\r\nexports.login = function (req, res) {\r\n    // console.log(req);\r\n    business.user.login(req.body.email, req.body.password).then(\r\n        user => {\r\n            business.utils.createToken(user, req.connection.remoteAddress).then(\r\n                token => res.status(200).json({ token: token, user: user.id }),\r\n                error => res.status(500).send(error.message));\r\n        },\r\n        error => res.status(500).send(error.message));\r\n}\r\n\r\n/**\r\n * @api {post} /chpass 03) Change password\r\n * @apiGroup Authentication\r\n * @apiName changePassword\r\n * @apiVersion 1.0.0\r\n * @apiUse auth\r\n * @apiHeader Authorization=\"< token >\"\r\n * @apiParam {string} old_password old password\r\n * @apiParam {string} new_password new password\r\n * @apiSuccess {boolean} result return true if was sucessfuly updated\r\n */\r\nexports.changePassword = function (req, res) {\r\n    if (req.client.constructor.name === \"User\") {\r\n        business.user.changePassword(req.client.id, req.body.old_password, req.body.new_password).then(\r\n            () => res.status(200).json({ result: true }),\r\n            error => res.status(500).send(error.message));\r\n    } else {\r\n        res.status(500).send(\"Unauthorized\");\r\n    }\r\n}","var business = require('../../business/index').v1_0_0;\r\n\r\n/**\r\n * @api {post} /sensor 01) Create\r\n * @apiGroup Sensor\r\n * @apiName createSensor\r\n * @apiDescription create a new sensor.\r\n * @apiVersion 1.0.0\r\n * @apiUse box\r\n * \r\n * @apiPermission admin\r\n * @apiParam {string} transducer transducer name\r\n * @apiParam {string} measure transducer measure\r\n * @apiParam {decimal} min_acceptable minimum acceptable value to sensor\r\n * @apiParam {decimal} max_acceptable maximum acceptable value to sensor\r\n * @apiParam {decimal} min_possible minimum possible value to sensor\r\n * @apiParam {decimal} max_possible maximum possible value to sensor\r\n * @apiParamExample {json} Request example:\r\n *      {\r\n *           \"transducer\": \"dht22\",\r\n *           \"measure\":\"temperature\",\r\n *           \"min_acceptable\": \"10\",\r\n *           \"max_acceptable\": \"25\",\r\n *           \"min_possible\": \"-20\",\r\n *           \"max_possible\": \"50\"\r\n *      }\r\n * @apiSuccess {string} id created sensor id\r\n */\r\nexports.create = (req, res) => {\r\n    if (req.client.constructor.name === \"User\" && req.client.admin) {\r\n        business.sensor.create(req.body).then(\r\n            sensor => res.status(200).json({ id: sensor.id }),\r\n            error => res.status(500).send(error.message));\r\n    } else {\r\n        res.status(500).send(\"Unauthorized\");\r\n    }\r\n}\r\n\r\n/**\r\n * @api {get} /sensor 02) List\r\n * @apiGroup Sensor\r\n * @apiName listSensors\r\n * @apiDescription list all sensors. \r\n * @apiVersion 1.0.0\r\n * @apiUse box\r\n *\r\n * @apiPermission admin\r\n * @apiSuccess {array} models list of sensors\r\n * @apiSuccess {string} transducer transducer name\r\n * @apiSuccess {string} measure transducer measure\r\n * @apiSuccess {decimal} min_acceptable minimum acceptable value to sensor\r\n * @apiSuccess {decimal} max_acceptable maximum acceptable value to sensor\r\n * @apiSuccess {decimal} min_possible minimum possible value to sensor\r\n * @apiSuccess {decimal} max_possible maximum possible value to sensor\r\n * @apiSuccessExample {json} Response example:\r\n * {\r\n *  \"sensors\": [\r\n *      {\r\n *          \"transducer\": \"dht22\",\r\n *          \"measure\":\"temperature\",\r\n *          \"min_acceptable\": \"10\",\r\n *          \"max_acceptable\": \"25\",\r\n *          \"min_possible\": \"-20\",\r\n *          \"max_possible\": \"50\"\r\n *      },\r\n *      {\r\n *          \"transducer\": \"mq-7\",\r\n *          \"measure\":\"carbon_monoxide\",\r\n *          \"min_acceptable\": \"2\",\r\n *          \"max_acceptable\": \"10\",\r\n *          \"min_possible\": \"10\",\r\n *          \"max_possible\": \"500\"\r\n *      }\r\n *  ]\r\n * }\r\n */\r\nexports.list = (req, res) => {\r\n    if (req.client.constructor.name === \"User\" && req.client.admin) {\r\n        business.sensor.list().then(\r\n            sensors => res.status(200).json({ sensors: sensors }),\r\n            error => res.status(500).send(error.message));\r\n    } else {\r\n        res.status(500).send(\"Unauthorized\");\r\n    }\r\n}\r\n\r\n/**\r\n * @api {put} /sensor/:id 03) Update\r\n * @apiGroup Sensor\r\n * @apiName updateSensor\r\n * @apiDescription update a sensor.\r\n * @apiVersion 1.0.0\r\n * @apiUse box\r\n * \r\n * @apiPermission admin\r\n * @apiParam {string} :id sensor id to update\r\n * @apiParam {string} transducer transducer name\r\n * @apiParam {string} measure transducer measure\r\n * @apiParam {decimal} min_acceptable minimum acceptable value to sensor\r\n * @apiParam {decimal} max_acceptable maximum acceptable value to sensor\r\n * @apiParam {decimal} min_possible minimum possible value to sensor\r\n * @apiParam {decimal} max_possible maximum possible value to sensor\r\n * @apiParamExample {json} Request example:\r\n *      {\r\n *           \"transducer\": \"dht22\",\r\n *           \"measure\":\"temperature\",\r\n *           \"min_acceptable\": \"10\",\r\n *           \"max_acceptable\": \"25\",\r\n *           \"min_possible\": \"-20\",\r\n *           \"max_possible\": \"50\"\r\n *      }\r\n * @apiSuccess {boolean} result return \"true\" if was sucessfuly updated\r\n */\r\nexports.update = (req, res) => {\r\n    if (req.client.constructor.name === \"User\" && req.client.admin) {\r\n        business.sensor.update(req.params.id, req.body).then(\r\n            () => res.status(200).json({ result: true }),\r\n            error => res.status(500).send(error.message));\r\n    } else {\r\n        res.status(500).send(\"Unauthorized\");\r\n    }\r\n}\r\n\r\n/**\r\n * @api {delete} /sensor/:id 04) Delete\r\n * @apiGroup Sensor\r\n * @apiName deleteSensor\r\n * @apiDescription remove a sensor\r\n * @apiVersion 1.0.0\r\n * @apiUse box\r\n * \r\n * @apiPermission admin\r\n * @apiParam {string} :id sensor ID to delete\r\n * @apiSuccess {boolean} result return \"true\" if was sucessfuly removed\r\n */\r\nexports.delete = (req, res) => {\r\n    if (req.client.constructor.name === \"User\" && req.client.admin) {\r\n        business.sensor.remove(req.params.id).then(\r\n            () => res.status(200).json({ result: true }),\r\n            error => res.status(500).send(error.message)\r\n        );\r\n    } else {\r\n        res.status(500).send(\"Unauthorized\");\r\n    }\r\n}","var business = require('../../business/index').v1_0_0;\r\n\r\n/**\r\n * @api {post} /record 1) Receive\r\n * @apiGroup Record\r\n * @apiName createRecord\r\n * @apiDescription receive data from vitabox about it sensors\r\n * @apiVersion 1.0.0\r\n * @apiUse box\r\n * \r\n * @apiPermission vitabox\r\n * @apiParam {decimal} value value catched\r\n * @apiParam {datetime} datetime moment when the value was catched\r\n * @apiParam {string} patient_id patient unique ID related to the value, may be null or omitted\r\n * @apiParam {string} board_id board unique ID related to the value\r\n * @apiParam {string} sensor_id sensor unique ID related to the value\r\n * @apiParamExample {json} Request example:\r\n * {\r\n *  \"records\":[\r\n *      {\r\n *          \"value\": 10,\r\n *          \"datetime\": \"2018-03-02T15:40:23.000Z\",\r\n *          \"patient_id\": \"7d9db945-d3f4-471a-a0f4-37f69c171dea\",\r\n *          \"board_id\": \"f2340471-23e2-4891-bb89-14888abcc29e\",\r\n *          \"sensor_id\": \"2a2f5839-6b68-41a6-ada7-f9cd4c66cf38\"\r\n *      },\r\n *      {\r\n *          \"value\": 13,\r\n *          \"datetime\": \"2018-03-02T15:36:26.000Z\",\r\n *          \"patient_id\": \"7d9db945-d3f4-471a-a0f4-37f69c171dea\",\r\n *          \"board_id\": \"f2340471-23e2-4891-bb89-14888abcc29e\",\r\n *          \"sensor_id\": \"2a2f5839-6b68-41a6-ada7-f9cd4c66cf38\"\r\n *      }\r\n *  ]\r\n * }\r\n * @apiSuccess {boolean} result return true if was sucessfuly recorded\r\n * @apiSuccess {string} error return \"\" if all records were valid and a error message if some records has invalid parameters\r\n * @apiSuccessExample {json} Response example:\r\n * {\r\n *  \"result\":true,\r\n *  \"error\": \"some records were discarded by invalid parameters: value, datetime, sensor_id and board_id are required\"\r\n * }\r\n */\r\nexports.create = function (req, res) {\r\n    if (req.client.constructor.name === \"Vitabox\") {\r\n        business.record.create(req.body.records).then(\r\n            invalid => {\r\n                if (invalid) res.status(200).json({ result: true, error: \"some records were discarded by invalid parameters, value, datetime, sensor_id and board_id are required\" });\r\n                else res.status(200).json({ result: true, error: \"\" });\r\n            },\r\n            error => res.status(500).json({ result: false, error: error.message }));\r\n    } else {\r\n        res.status(500).json({ error: \"Unauthorized\" });\r\n    }\r\n}\r\n\r\n/**\r\n * @api {post} /record/patient/:id 2) List by Patient\r\n * @apiGroup Record\r\n * @apiName listRecordsByPatient\r\n * @apiDescription list all records by patient\r\n * @apiVersion 1.0.0\r\n * @apiUse box\r\n * \r\n * @apiPermission user\r\n * @apiParam {string} :id patient unique ID\r\n * @apiSuccess {array} records records list\r\n * @apiSuccess {decimal} value value catched\r\n * @apiSuccess {datetime} datetime moment when the value was catched\r\n * @apiSuccess {string} patient_id patient unique ID related to the value\r\n * @apiSuccess {string} board_id board unique ID related to the value\r\n * @apiSuccess {string} sensor_id sensor unique ID related to the value\r\n * @apiSuccessExample {json} Response example:\r\n * {\r\n *  \"records\": [\r\n *      {\r\n *          \"datetime\": \"2018-03-02T15:40:23.000Z\",\r\n *          \"value\": 10,\r\n *          \"patient_id\": \"7d9db945-d3f4-471a-a0f4-37f69c171dea\",\r\n *          \"board_id\": \"f2340471-23e2-4891-bb89-14888abcc29e\",\r\n *          \"sensor_id\": \"2a2f5839-6b68-41a6-ada7-f9cd4c66cf38\"\r\n *      },\r\n *      {\r\n *          \"datetime\": \"2018-03-02T15:36:26.000Z\",\r\n *          \"value\": 13,\r\n *          \"patient_id\": \"7d9db945-d3f4-471a-a0f4-37f69c171dea\",\r\n *          \"board_id\": \"f2340471-23e2-4891-bb89-14888abcc29e\",\r\n *          \"sensor_id\": \"2a2f5839-6b68-41a6-ada7-f9cd4c66cf38\"\r\n *      }\r\n *  ]\r\n * }\r\n */\r\nexports.listByPatient = function (req, res) {\r\n    if (req.client.constructor.name === \"User\") {\r\n        business.record.listByPatient(req.client, req.params.id).then(\r\n            data => res.status(200).json({ records: data }),\r\n            error => res.status(500).send(error.message));\r\n    } else {\r\n        res.status(500).send(\"Unauthorized\");\r\n    }\r\n}\r\n\r\n/**\r\n * @api {post} /record/board/:id 3) List by Board\r\n * @apiGroup Record\r\n * @apiName listRecordsByBoard\r\n * @apiDescription list all records by board\r\n * @apiVersion 1.0.0\r\n * @apiUse box\r\n * \r\n * @apiPermission user\r\n * @apiParam {string} :id board unique ID\r\n * @apiSuccess {array} records records list\r\n * @apiSuccess {decimal} value value catched\r\n * @apiSuccess {datetime} datetime moment when the value was catched\r\n * @apiSuccess {string} patient_id patient unique ID related to the value\r\n * @apiSuccess {string} board_id board unique ID related to the value\r\n * @apiSuccess {string} sensor_id sensor unique ID related to the value\r\n * @apiSuccessExample {json} Response example:\r\n * {\r\n *  \"records\": [\r\n *      {\r\n *          \"datetime\": \"2018-03-02T15:40:23.000Z\",\r\n *          \"value\": 10,\r\n *          \"patient_id\": \"7d9db945-d3f4-471a-a0f4-37f69c171dea\",\r\n *          \"board_id\": \"f2340471-23e2-4891-bb89-14888abcc29e\",\r\n *          \"sensor_id\": \"2a2f5839-6b68-41a6-ada7-f9cd4c66cf38\"\r\n *      },\r\n *      {\r\n *          \"datetime\": \"2018-03-02T15:36:26.000Z\",\r\n *          \"value\": 13,\r\n *          \"patient_id\": \"7d9db945-d3f4-471a-a0f4-37f69c171dea\",\r\n *          \"board_id\": \"f2340471-23e2-4891-bb89-14888abcc29e\",\r\n *          \"sensor_id\": \"2a2f5839-6b68-41a6-ada7-f9cd4c66cf38\"\r\n *      }\r\n *  ]\r\n * }\r\n */\r\nexports.listByBoard = function (req, res) {\r\n    if (req.client.constructor.name === \"User\") {\r\n        business.record.listByBoard(req.client, req.params.id).then(\r\n            data => res.status(200).json({ records: data }),\r\n            error => res.status(500).send(error.message));\r\n    } else {\r\n        res.status(500).send(\"Unauthorized\");\r\n    }\r\n}\r\n\r\n/**\r\n * @api {post} /record/sensor/:id 4) List by Sensor\r\n * @apiGroup Record\r\n * @apiName listRecordsBySensor\r\n * @apiDescription list all records by sensor\r\n * @apiVersion 1.0.0\r\n * @apiUse box\r\n * \r\n * @apiPermission admin\r\n * @apiParam {string} :id sensor unique ID\r\n * @apiSuccess {array} records records list\r\n * @apiSuccess {decimal} value value catched\r\n * @apiSuccess {datetime} datetime moment when the value was catched\r\n * @apiSuccess {string} patient_id patient unique ID related to the value\r\n * @apiSuccess {string} board_id board unique ID related to the value\r\n * @apiSuccess {string} sensor_id sensor unique ID related to the value\r\n * @apiSuccessExample {json} Response example:\r\n * {\r\n *  \"records\": [\r\n *      {\r\n *          \"datetime\": \"2018-03-02T15:40:23.000Z\",\r\n *          \"value\": 10,\r\n *          \"patient_id\": \"7d9db945-d3f4-471a-a0f4-37f69c171dea\",\r\n *          \"board_id\": \"f2340471-23e2-4891-bb89-14888abcc29e\",\r\n *          \"sensor_id\": \"2a2f5839-6b68-41a6-ada7-f9cd4c66cf38\"\r\n *      },\r\n *      {\r\n *          \"datetime\": \"2018-03-02T15:36:26.000Z\",\r\n *          \"value\": 13,\r\n *          \"patient_id\": \"7d9db945-d3f4-471a-a0f4-37f69c171dea\",\r\n *          \"board_id\": \"f2340471-23e2-4891-bb89-14888abcc29e\",\r\n *          \"sensor_id\": \"2a2f5839-6b68-41a6-ada7-f9cd4c66cf38\"\r\n *      }\r\n *  ]\r\n * }\r\n */\r\nexports.listBySensor = function (req, res) {\r\n    if (req.client.constructor.name === \"User\" && req.client.admin) {\r\n        business.record.listBySensor(req.client, req.params.id).then(\r\n            data => res.status(200).json({ records: data }),\r\n            error => res.status(500).send(error.message));\r\n    } else {\r\n        res.status(500).send(\"Unauthorized\");\r\n    }\r\n}","var business = require('../../business/index').v1_0_0;\r\n\r\nexports.destroyAll = function (req, res) {\r\n    business.utils.deleteAll().then(\r\n        () => res.status(200).json({ success: true }),\r\n        error => res.status(500).send(error.message)\r\n    );\r\n}\r\n\r\nexports.testDb = function (req, res) {\r\n    business.utils.deleteAll().then(\r\n        () => business.utils.testSeed().then(\r\n            res.status(200).json({ success: true }),\r\n            error => res.status(500).send(error.message)),\r\n        error => res.status(500).send(error.message));\r\n}","var business = require('../../business/index').v1_0_0;\r\n","var db = require('../../models/index'),\r\n    utils = require('./utils');\r\n\r\nexports.create = function () {\r\n    return new Promise((resolve, reject) => {\r\n        let password = utils.generatePassword();\r\n        utils.encrypt([password]).then(\r\n            encrypted => {\r\n                db.Vitabox.create({ password: encrypted[0] }).then(\r\n                    vitabox => resolve({\r\n                        id: vitabox.id,\r\n                        password: password\r\n                    }),\r\n                    error => reject(error));\r\n            }, error => reject(error));\r\n    });\r\n}\r\n\r\nexports.register = function (vitabox_id, attributes) {\r\n    return new Promise((resolve, reject) => {\r\n        if (attributes.address) {\r\n            db.Vitabox.findOne({ where: { id: vitabox_id, registered: false } }).then(vitabox => {\r\n                if (vitabox) {\r\n                    vitabox.update({ registered: true, address: attributes.address, longitude: attributes.longitude, latitude: attributes.latitude }).then(\r\n                        () => resolve(vitabox),\r\n                        error => reject(error));\r\n                } else reject(new Error(\"Vitabox already registered or doesnt exist\"));\r\n            }, error => reject(error));\r\n        } else reject(new Error(\"Vitabox address must be defined\"));\r\n    });\r\n}\r\n\r\nexports.connect = function (vitabox_id, password) {\r\n    return new Promise((resolve, reject) => {\r\n        utils.encrypt([password]).then(\r\n            encrypted => {\r\n                db.Vitabox.findOne({ where: { password: encrypted[0], id: vitabox_id, registered: true } }).then(\r\n                    vitabox => {\r\n                        if (vitabox) {\r\n                            vitabox.update({ active: true }).then(\r\n                                () => resolve(vitabox),\r\n                                error => reject(error));\r\n                        } else reject(new Error(\"vitabox not found, verify if was already created and registered\"));\r\n                    }, error => reject(error));\r\n            }, error => reject(error));\r\n    });\r\n}\r\n\r\nexports.list = function (current_user) {\r\n    return new Promise((resolve, reject) => {\r\n        if (current_user.admin) {\r\n            db.Vitabox.findAll({ attributes: { exclude: ['password'] } }).then(\r\n                list => resolve(list),\r\n                error => reject(error));\r\n        } else {\r\n            current_user.getVitaboxes({ attributes: ['id', 'latitude', 'longitude', 'address'], where: { active: true } }).then(\r\n                list => {\r\n                    list.forEach(element => {\r\n                        element.dataValues.sponsor = element.dataValues.UserVitabox.dataValues.sponsor;\r\n                        delete element.dataValues.UserVitabox;\r\n                    })\r\n                    resolve(list);\r\n                }, error => reject(error));\r\n        }\r\n    });\r\n}\r\n\r\nexports.find = function (current_user, vitabox_id) {\r\n    return new Promise((resolve, reject) => {\r\n        if (current_user.admin) {\r\n            db.Vitabox.findById(vitabox_id, { attributes: { exclude: ['password'] } }).then(\r\n                vitabox => {\r\n                    if (vitabox) resolve(vitabox);\r\n                    else reject(new Error(\"Vitabox not found\"));\r\n                }, error => reject(error));\r\n        }\r\n        else {\r\n            current_user.getVitaboxes({\r\n                attributes: ['id', 'latitude', 'longitude', 'address'],\r\n                where: { id: vitabox_id, active: true }\r\n            }).then(vitabox => {\r\n                if (vitabox.length > 0) {\r\n                    vitabox[0].dataValues.sponsor = vitabox[0].dataValues.UserVitabox.dataValues.sponsor;\r\n                    delete vitabox[0].dataValues.UserVitabox;\r\n                    resolve(vitabox[0]);\r\n                } else reject(new Error(\"Vitabox not found\"));\r\n            }, error => reject(error));\r\n        }\r\n    });\r\n}\r\n\r\nexports.update = function (current_user, vitabox_id, attributes) {\r\n    return new Promise((resolve, reject) => {\r\n        db.Vitabox.findById(vitabox_id).then(\r\n            vitabox => {\r\n                if (vitabox) {\r\n                    if (current_user.admin)\r\n                        vitabox.update({ latitude: attributes.latitude, longitude: attributes.longitude, address: attributes.address, settings: attributes.settings }).then(\r\n                            () => resolve(),\r\n                            error => reject(error));\r\n                    else _isSponsor(vitabox, current_user).then(\r\n                        () => {\r\n                            vitabox.update({ latitude: attributes.latitude, longitude: attributes.longitude, address: attributes.address }).then(\r\n                                () => resolve(),\r\n                                error => reject(error));\r\n                        }, error => reject(error)\r\n                    );\r\n                } else reject(new Error(\"Vitabox not found\"));\r\n            }, error => reject(error)\r\n        );\r\n    });\r\n}\r\n\r\nexports.delete = function (current_user, vitabox_id) {\r\n    return new Promise((resolve, reject) => {\r\n        db.Vitabox.findById(vitabox_id).then(\r\n            vitabox => {\r\n                if (vitabox) {\r\n                    if (current_user.admin)\r\n                        vitabox.destroy().then(\r\n                            () => resolve(),\r\n                            error => reject(error.message));\r\n                    else _isSponsor(vitabox, current_user).then(\r\n                        () => {\r\n                            vitabox.destroy().then(\r\n                                () => resolve(),\r\n                                error => reject(error.message));\r\n                        }, error => reject(error)\r\n                    );\r\n                } else reject(new Error(\"Vitabox not found\"));\r\n            }, error => reject(error)\r\n        );\r\n    });\r\n}\r\n\r\nexports.addUser = function (current_user, vitabox_id, user_id, is_sponsor) {\r\n    return new Promise((resolve, reject) => {\r\n        db.Vitabox.findById(vitabox_id).then(\r\n            vitabox => {\r\n                if (vitabox) {\r\n                    if (current_user.admin)\r\n                        vitabox.addUser(user_id, { through: { sponsor: is_sponsor } }).then(\r\n                            () => resolve(),\r\n                            error => reject(error));\r\n                    else _isSponsor(vitabox, current_user).then(\r\n                        () => {\r\n                            vitabox.addUser(user_id, { through: { sponsor: is_sponsor } }).then(\r\n                                () => resolve(),\r\n                                error => reject(error));\r\n                        }, error => reject(error)\r\n                    );\r\n                } else reject(new Error(\"Vitabox not found\"));\r\n            }, error => reject(error)\r\n        );\r\n    });\r\n}\r\n\r\nexports.getUsers = function (is_user, client, vitabox_id) {\r\n    return new Promise((resolve, reject) => {\r\n        if (is_user) {\r\n            db.Vitabox.findById(vitabox_id).then(\r\n                vitabox => {\r\n                    if (vitabox) {\r\n                        if (client.admin)\r\n                            vitabox.getUsers({ attributes: ['id', 'email'] }).then(\r\n                                users => {\r\n                                    users.forEach(user => {\r\n                                        user.email = utils.decrypt(user.email);\r\n                                        user.dataValues.since = user.dataValues.UserVitabox.dataValues.created_at;\r\n                                        user.dataValues.sponsor = user.dataValues.UserVitabox.dataValues.sponsor;\r\n                                        delete user.dataValues.UserVitabox;\r\n                                    });\r\n                                    resolve(users);\r\n                                },\r\n                                error => reject(error));\r\n                        else _isUser(vitabox, client).then(\r\n                            () => {\r\n                                vitabox.getUsers({ attributes: ['id', 'email'] }).then(\r\n                                    users => {\r\n                                        users.forEach(user => {\r\n                                            user.email = utils.decrypt(user.email);\r\n                                            user.dataValues.since = user.dataValues.UserVitabox.dataValues.created_at;\r\n                                            user.dataValues.sponsor = user.dataValues.UserVitabox.dataValues.sponsor;\r\n                                            delete user.dataValues.UserVitabox;\r\n                                        });\r\n                                        resolve(users);\r\n                                    },\r\n                                    error => reject(error));\r\n                            }, error => reject(error)\r\n                        );\r\n                    } else reject(new Error(\"Vitabox not found\"));\r\n                }, error => reject(error));\r\n        } else {\r\n            client.getUsers({ attributes: ['id', 'email'] }).then(\r\n                users => {\r\n                    users.forEach(user => {\r\n                        user.email = utils.decrypt(user.email);\r\n                        user.dataValues.since = user.dataValues.UserVitabox.dataValues.created_at;\r\n                        user.dataValues.sponsor = user.dataValues.UserVitabox.dataValues.sponsor;\r\n                        delete user.dataValues.UserVitabox;\r\n                    });\r\n                    resolve(users);\r\n                },\r\n                error => reject(error));\r\n        }\r\n    });\r\n}\r\n\r\nexports.removeUser = function (current_user, vitabox_id, user_id) {\r\n    return new Promise((resolve, reject) => {\r\n        db.Vitabox.findById(vitabox_id).then(\r\n            vitabox => {\r\n                if (vitabox) {\r\n                    if (current_user.admin)\r\n                        vitabox.removeUser(user_id).then(\r\n                            () => resolve(),\r\n                            error => reject(error));\r\n                    else _isSponsor(vitabox, current_user).then(\r\n                        () => {\r\n                            vitabox.removeUser(user_id).then(\r\n                                () => resolve(),\r\n                                error => reject(error));\r\n                        }, error => reject(error));\r\n                } else reject(new Error(\"Vitabox not found\"));\r\n            }, error => reject(error)\r\n        );\r\n    });\r\n}\r\n\r\nexports.addPatient = function (current_user, vitabox_id, patient_id) {\r\n    return new Promise((resolve, reject) => {\r\n        db.Vitabox.findById(vitabox_id).then(\r\n            vitabox => {\r\n                if (vitabox) {\r\n                    if (current_user.admin)\r\n                        vitabox.addPatient(patient_id).then(\r\n                            () => resolve(),\r\n                            error => reject(error));\r\n                    else _isSponsor(vitabox, current_user).then(\r\n                        () => {\r\n                            vitabox.addPatient(patient_id).then(\r\n                                () => resolve(),\r\n                                error => reject(error));\r\n                        }, error => reject(error)\r\n                    );\r\n                } else reject(new Error(\"Vitabox not found\"));\r\n            }, error => reject(error)\r\n        );\r\n    });\r\n}\r\n\r\nexports.getPatients = function (is_user, client, vitabox_id) {\r\n    return new Promise((resolve, reject) => {\r\n        if (is_user) {\r\n            if (client.admin)\r\n                db.Patient.findAll({ where: { vitabox_id: vitabox_id }, attributes: ['id', 'birthdate', 'name', 'gender', ['created_at', 'since']] }).then(\r\n                    patients => {\r\n                        patients.forEach(patient => patient.name = utils.decrypt(patient.name));\r\n                        resolve(patients);\r\n                    },\r\n                    error => reject(error));\r\n            else db.Vitabox.findById(vitabox_id).then(\r\n                vitabox => {\r\n                    if (vitabox) {\r\n                        _isUser(vitabox, client).then(\r\n                            () => {\r\n                                db.Patient.findAll({ where: { vitabox_id: vitabox_id }, attributes: ['id', 'birthdate', 'name', 'gender', ['created_at', 'since']] }).then(\r\n                                    patients => {\r\n                                        patients.forEach(patient => patient.name = utils.decrypt(patient.name));\r\n                                        resolve(patients);\r\n                                    },\r\n                                    error => reject(error));\r\n                            }, error => reject(error));\r\n                    } else reject(new Error(\"Vitabox not found\"));\r\n                }, error => reject(error));\r\n        } else {\r\n            client.getPatients({ attributes: ['id', 'birthdate', 'name', 'gender', ['created_at', 'since']] }).then(\r\n                patients => {\r\n                    patients.forEach(patient => {\r\n                        patient.name = utils.decrypt(patient.name);\r\n                        delete patient.dataValues.VitaboxId;\r\n                    });\r\n                    resolve(patients);\r\n                },\r\n                error => reject(error));\r\n        }\r\n    });\r\n}\r\n\r\nexports.removePatient = function (current_user, vitabox_id, patient_id) {\r\n    return new Promise((resolve, reject) => {\r\n        db.Vitabox.findById(vitabox_id).then(\r\n            vitabox => {\r\n                if (vitabox) {\r\n                    if (current_user.admin)\r\n                        vitabox.removePatient(patient_id).then(\r\n                            () => resolve(),\r\n                            error => reject(error));\r\n                    else _isSponsor(vitabox, current_user).then(\r\n                        () => {\r\n                            vitabox.removePatient(patient_id).then(\r\n                                () => resolve(),\r\n                                error => reject(error));\r\n                        }, error => reject(error)\r\n                    );\r\n                } else reject(new Error(\"Vitabox not found\"));\r\n            }, error => reject(error)\r\n        );\r\n    });\r\n}\r\n\r\nexports.addBoard = function (current_user, vitabox_id, board_id) {\r\n    return new Promise((resolve, reject) => {\r\n        db.Vitabox.findById(vitabox_id).then(\r\n            vitabox => {\r\n                if (vitabox) {\r\n                    if (current_user.admin)\r\n                        vitabox.addBoard(board_id).then(\r\n                            () => resolve(),\r\n                            error => reject(error));\r\n                    else _isSponsor(vitabox, current_user).then(\r\n                        () => {\r\n                            vitabox.addBoard(board_id).then(\r\n                                () => resolve(),\r\n                                error => reject(error));\r\n                        }, error => reject(error)\r\n                    );\r\n                } else reject(new Error(\"Vitabox not found\"));\r\n            }, error => reject(error)\r\n        );\r\n    });\r\n}\r\n\r\nexports.getBoards = function (is_user, client, vitabox_id) {\r\n    return new Promise((resolve, reject) => {\r\n        if (is_user) {\r\n            if (client.admin)\r\n                db.Board.findAll({\r\n                    where: { vitabox_id: vitabox_id },\r\n                    attributes: ['id', 'location', 'mac_address', 'created_at'],\r\n                    include: [{\r\n                        model: db.Boardmodel,\r\n                        attributes: ['id', 'type', 'name'],\r\n                        include: [{\r\n                            model: db.Sensor,\r\n                            attributes: { exclude: ['created_at', 'updated_at'] }\r\n                        }]\r\n                    }]\r\n                }).then(\r\n                    boards => {\r\n                        boards.forEach(board => board.Boardmodel.Sensors.forEach(sensor => delete sensor.dataValues.BoardSensor));\r\n                        resolve(boards);\r\n                    },\r\n                    error => reject(error));\r\n            else db.Vitabox.findById(vitabox_id).then(\r\n                vitabox => {\r\n                    if (vitabox) {\r\n                        _isUser(vitabox, client).then(\r\n                            () => {\r\n                                db.Board.findAll({\r\n                                    where: { vitabox_id: vitabox_id },\r\n                                    attributes: ['id', 'location', 'mac_address', 'created_at'],\r\n                                    include: [{\r\n                                        model: db.Boardmodel,\r\n                                        attributes: ['id', 'type', 'name'],\r\n                                        include: [{\r\n                                            model: db.Sensor,\r\n                                            attributes: { exclude: ['created_at', 'updated_at'] }\r\n                                        }]\r\n                                    }]\r\n                                }).then(\r\n                                    boards => {\r\n                                        boards.forEach(board => board.Boardmodel.Sensors.forEach(sensor => delete sensor.dataValues.BoardSensor));\r\n                                        resolve(boards);\r\n                                    },\r\n                                    error => reject(error));\r\n                            }, error => reject(error));\r\n                    } else reject(new Error(\"Vitabox not found\"));\r\n                }, error => reject(error));\r\n        } else {\r\n            client.getBoards({\r\n                attributes: ['id', 'location', 'mac_address', 'created_at'],\r\n                include: [{\r\n                    model: db.Boardmodel,\r\n                    attributes: ['id', 'type', 'name'],\r\n                    include: [{\r\n                        model: db.Sensor,\r\n                        attributes: { exclude: ['created_at', 'updated_at'] }\r\n                    }]\r\n                }],\r\n            }).then(\r\n                boards => {\r\n                    boards.forEach(board => board.Boardmodel.Sensors.forEach(sensor => delete sensor.dataValues.BoardSensor));\r\n                    resolve(boards);\r\n                },\r\n                error => reject(error));\r\n        }\r\n    });\r\n}\r\n\r\nexports.removeBoard = function (current_user, vitabox_id, board_id) {\r\n    return new Promise((resolve, reject) => {\r\n        db.Vitabox.findById(vitabox_id).then(\r\n            vitabox => {\r\n                if (vitabox) {\r\n                    if (current_user.admin)\r\n                        vitabox.removeBoard(board_id).then(\r\n                            () => resolve(),\r\n                            error => reject(error));\r\n                    else _isSponsor(vitabox, current_user).then(\r\n                        () => {\r\n                            vitabox.removeBoard(board_id).then(\r\n                                () => resolve(),\r\n                                error => reject(error));\r\n                        }, error => reject(error)\r\n                    );\r\n                } else reject(new Error(\"Vitabox not found\"));\r\n            }, error => reject(error));\r\n    });\r\n}\r\n\r\n// ________________________________________________________________________\r\n// Private\r\n// ________________________________________________________________________\r\n_isSponsor = (vitabox, user) => {\r\n    return new Promise((resolve, reject) => {\r\n        vitabox.getUsers({ where: { id: user.id } }).then(\r\n            users => {\r\n                if (users.length > 0 && users[0].UserVitabox.sponsor) resolve();\r\n                else reject(new Error(\"Unauthorized\"));\r\n            }, error => reject(error));\r\n    });\r\n}\r\n\r\n_isUser = (vitabox, user) => {\r\n    return new Promise((resolve, reject) => {\r\n        vitabox.hasUser(user).then(\r\n            success => {\r\n                if (success) resolve();\r\n                else reject(new Error(\"Unauthorized\"));\r\n            }, error => reject(error));\r\n    });\r\n}","var db = require('../../models/index'),\r\n    utils = require('./utils');\r\n\r\nexports.register = function (email, password) {\r\n    return new Promise((resolve, reject) => {\r\n\r\n        if (/^(?=.*[A-Z])(?=.*[a-z])(?=.*\\d)[A-Za-z\\d$@$!%*#?&-.]{8,}$/.test(password)) {\r\n            if (/^(([^<>()\\[\\]\\.,;:\\s@\\\"]+(\\.[^<>()\\[\\]\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@(([^<>()[\\]\\.,;:\\s@\\\"]+\\.)+[^<>()[\\]\\.,;:\\s@\\\"]{2,})$/.test(email)) {\r\n\r\n                utils.encrypt([email, password]).then(\r\n                    encrypted => {\r\n                        db.User.create({ email: encrypted[0], password: encrypted[1] }).then(\r\n                            new_user => resolve(new_user),\r\n                            err => reject(err));\r\n                    },\r\n                    error => reject(error));\r\n            } else reject(new Error(\"invalid email\"));\r\n        } else reject(new Error(\"invalid password, must have at least one uppercase letter, one lowercase, one digit and a minimum 8 characters\"));\r\n    });\r\n}\r\n\r\nexports.login = function (email, password) {\r\n    return new Promise((resolve, reject) => {\r\n\r\n        utils.encrypt([email, password]).then(\r\n            encrypted => {\r\n                db.User.findOne({ where: { email: encrypted[0], password: encrypted[1] } }).then(\r\n                    user => {\r\n                        if (user) resolve(user);\r\n                        else reject(new Error(\"email and password don't match\"));\r\n                    }, error => reject(error));\r\n            }, error => reject(error));\r\n    });\r\n}\r\n\r\nexports.changePassword = function (user_id, old_password, new_password) {\r\n    return new Promise((resolve, reject) => {\r\n        if (/^(?=.*[A-Z])(?=.*[a-z])(?=.*\\d)[A-Za-z\\d$@$!%*#?&-.]{8,}$/.test(new_password)) {\r\n            utils.encrypt([old_password, new_password]).then(\r\n                encrypted => {\r\n                    db.User.findOne({ where: { id: user_id, password: encrypted[0] } }).then(\r\n                        user => {\r\n                            if (user) user.update({ password: encrypted[1] }).then(\r\n                                () => resolve(),\r\n                                error => reject(error));\r\n                            else reject(new Error(\"old password don't match\"));\r\n                        },\r\n                        error => reject(error));\r\n                }, error => reject(error));\r\n        } else reject(new Error(\"invalid password, must have at least one uppercase letter, one lowercase, one digit and a minimum 8 characters\"));\r\n    });\r\n}\r\n\r\nexports.findByEmail = function (email, password) {\r\n    return new Promise((resolve, reject) => {\r\n        utils.encrypt([email]).then(\r\n            encrypted => {\r\n                db.User.findOne({ where: { email: encrypted[0] } }).then(\r\n                    user => {\r\n                        if (user) resolve(user);\r\n                        else reject(new Error(\"user not registered\"));\r\n                    }, error => reject(error));\r\n            }, error => reject(error));\r\n    });\r\n}","var db = require('../../models/index');\r\n\r\nexports.create = (attributes) => {\r\n    return new Promise((resolve, reject) => {\r\n        db.Sensor.create({ transducer: attributes.transducer, measure: attributes.measure, min_acceptable: attributes.min_acceptable, max_acceptable: attributes.max_acceptable, min_possible: attributes.min_possible, max_possible: attributes.max_possible }).then(\r\n            sensor => resolve(sensor),\r\n            error => reject(error));\r\n    });\r\n}\r\n\r\nexports.list = (attributes) => {\r\n    return new Promise((resolve, reject) => {\r\n        db.Sensor.findAll({ attributes: { exclude: ['created_at', 'updated_at'] } }).then(\r\n            sensors => resolve(sensors),\r\n            error => reject(error));\r\n    });\r\n}\r\n\r\nexports.update = (sensor_id, attributes) => {\r\n    return new Promise((resolve, reject) => {\r\n        db.Sensor.findById(sensor_id).then(\r\n            sensor => {\r\n                if (sensor) sensor.update({ transducer: attributes.transducer, measure: attributes.measure, min_acceptable: attributes.min_acceptable, max_acceptable: attributes.max_acceptable, min_possible: attributes.min_possible, max_possible: attributes.max_possible }).then(\r\n                    () => resolve(),\r\n                    error => reject(error));\r\n                else reject(new Error(\"sensor not found\"));\r\n            }, error => reject(error));\r\n    });\r\n}\r\n\r\nexports.remove = (sensor_id) => {\r\n    return new Promise((resolve, reject) => {\r\n        db.Sensor.findById(sensor_id).then(\r\n            sensor => {\r\n                if (sensor) sensor.destroy().then(\r\n                    () => resolve(),\r\n                    error => reject(error));\r\n                else reject(new Error(\"sensor not found\"));\r\n            }, error => reject(error));\r\n    });\r\n}","var db = require('../../models/index');\r\n\r\nexports.create = function (body) {\r\n    return new Promise((resolve, reject) => {\r\n        var to_insert = [], invalid = false;\r\n        body.forEach(element => {\r\n            if (element.board_id && element.board_id !== '' && element.sensor_id && element.sensor_id !== '' && element.value && element.datetime)\r\n                to_insert.push({\r\n                    value: element.value,\r\n                    datetime: element.datetime,\r\n                    patient_id: (element.patient_id && element.patient_id !== \"\") ? element.patient_id : null,\r\n                    board_id: element.board_id,\r\n                    sensor_id: element.sensor_id\r\n                });\r\n            else invalid = true\r\n        });\r\n        db.Record.insertMany(to_insert, (error, doc) => {\r\n            if (error) reject(error);\r\n            else resolve(invalid);\r\n        });\r\n    });\r\n}\r\n\r\nexports.listByPatient = function (current_user, patient_id) {\r\n    return new Promise((resolve, reject) => {\r\n        if (current_user.admin) db.Record.find().where('patient_id').equals(patient_id).select(\"-_id\").exec((error, doc) => {\r\n            if (error) reject(error);\r\n            else resolve(doc);\r\n        });\r\n        else db.Patient.findById(patient_id, { include: [{ model: db.Vitabox }] }).then(\r\n            patient => patient.Vitabox.hasUser(current_user).then(\r\n                success => {\r\n                    if (success)\r\n                        db.Record.find().where('patient_id').equals(patient_id).select(\"-_id\").exec((error, doc) => {\r\n                            if (error) reject(error);\r\n                            else resolve(doc);\r\n                        });\r\n                    else reject(\"Unauthorized\");\r\n                },\r\n                error => reject(error)),\r\n            error => reject(error));\r\n    });\r\n}\r\n\r\nexports.listByBoard = function (current_user, board_id) {\r\n    return new Promise((resolve, reject) => {\r\n        if (current_user.admin) db.Record.find().where('board_id').equals(board_id).select(\"-_id\").exec((error, doc) => {\r\n            if (error) reject(error);\r\n            else resolve(doc);\r\n        });\r\n        else db.Board.findById(board_id, { include: [{ model: db.Vitabox }] }).then(\r\n            board => board.Vitabox.hasUser(current_user).then(\r\n                success => {\r\n                    if (success)\r\n                        db.Record.find().where('board_id').equals(board_id).select(\"-_id\").exec((error, doc) => {\r\n                            if (error) reject(error);\r\n                            else resolve(doc)\r\n                        });\r\n                    else reject(\"Unauthorized\");\r\n                },\r\n                error => reject(error)),\r\n            error => reject(error));\r\n    });\r\n}\r\n\r\nexports.listBySensor = function (current_user, sensor_id) {\r\n    return new Promise((resolve, reject) => {\r\n        db.Record.find().where('sensor_id').equals(sensor_id).select(\"-_id\").exec((error, doc) => {\r\n            if (error) reject(error);\r\n            else resolve(doc);\r\n        });\r\n    });\r\n}","var db = require('../../models/index'),\r\n    utils = require('./utils');\r\n\r\nexports.create = (attributes) => {\r\n    return new Promise((resolve, reject) => {\r\n        if (/[A-Z][a-zA-Z\\'][^#&<>\\\"~;$^%{}?!*+_\\-@,0-9]{1,20}$/.test(attributes.name)) {\r\n            utils.encrypt([attributes.name]).then(\r\n                encrypted_name => db.Patient.create({\r\n                    name: encrypted_name[0],\r\n                    birthdate: attributes.birthdate,\r\n                    gender: attributes.gender\r\n                }).then(\r\n                    patient => resolve(patient),\r\n                    error => reject(error)\r\n                ), error => reject(error)\r\n            );\r\n        } else reject(new Error(\"invalid name\"));\r\n    });\r\n}","var db = require('../../models/index');\r\n\r\nexports.create = (attributes) => {\r\n    return new Promise((resolve, reject) => {\r\n        db.Board.create({ location: attributes.location, mac_address: attributes.mac_address, boardmodel_id: attributes.model }).then(\r\n            board => resolve(board),\r\n            error => reject(error));\r\n    });\r\n}\r\n\r\nexports.find = (board_id) => {\r\n    return new Promise((resolve, reject) => {\r\n        db.Board.findById(board_id).then(\r\n            board => {\r\n                board.getBoardmodel().then(\r\n                    model => resolve(model),\r\n                    error => reject(error))\r\n            },\r\n            error => reject(error));\r\n    });\r\n}\r\n\r\nexports.remove = (board_id) => {\r\n    return new Promise((resolve, reject) => {\r\n        db.Board.findById(board_id).then(\r\n            board => board.destroy().then(\r\n                () => resolve(),\r\n                error => reject(error)),\r\n            error => reject(error));\r\n    });\r\n}","var db = require('../../models/index');\r\n\r\nexports.create = (attributes) => {\r\n    return new Promise((resolve, reject) => {\r\n        db.Boardmodel.create({ type: attributes.type, name: attributes.name }).then(\r\n            model => resolve(model),\r\n            error => reject(error));\r\n    });\r\n}\r\n\r\nexports.list = () => {\r\n    return new Promise((resolve, reject) => {\r\n        db.Boardmodel.findAll({ attributes: ['id', 'type', 'name'] }).then(\r\n            models => resolve(models),\r\n            error => reject(error));\r\n    });\r\n}\r\n\r\nexports.update = (board_model_id, attributes) => {\r\n    return new Promise((resolve, reject) => {\r\n        db.Boardmodel.findById(board_model_id).then(\r\n            model => {\r\n                if (model) model.update({ type: attributes.type, name: attributes.name }).then(\r\n                    () => resolve(),\r\n                    error => reject(error));\r\n                else reject(new Error(\"board model not found\"));\r\n            }, error => reject(error));\r\n    });\r\n}\r\n\r\nexports.remove = (board_model_id) => {\r\n    return new Promise((resolve, reject) => {\r\n        db.Boardmodel.findById(board_model_id).then(\r\n            model => {\r\n                if (model) model.destroy().then(\r\n                    () => resolve(),\r\n                    error => reject(error));\r\n                else reject(new Error(\"board model not found\"));\r\n            }, error => reject(error));\r\n    });\r\n}\r\n\r\nexports.setSensor = (board_model_id, sensor_id) => {\r\n    return new Promise((resolve, reject) => {\r\n        db.Boardmodel.findById(board_model_id).then(\r\n            model => {\r\n                if (model) model.hasSensor(sensor_id).then(\r\n                    success => {\r\n                        if (!success) model.addSensor(sensor_id).then(\r\n                            () => resolve(),\r\n                            error => reject(error));\r\n                        else reject(new Error(\"sensor is already associated\"));\r\n                    }, error => reject(error));\r\n                else reject(new Error(\"board model not found\"));\r\n            }, error => reject(error));\r\n    });\r\n}\r\n\r\nexports.getSensors = (board_model_id) => {\r\n    return new Promise((resolve, reject) => {\r\n        db.Boardmodel.findById(board_model_id).then(\r\n            model => {\r\n                if (model) model.getSensors({ attributes: { exclude: ['created_at', 'updated_at'] } }).then(\r\n                    sensors => {\r\n                        sensors.forEach(element => delete element.dataValues.BoardSensor);\r\n                        resolve(sensors)\r\n                    },\r\n                    error => reject(error));\r\n                else reject(new Error(\"board model not found\"));\r\n            }, error => reject(error));\r\n    });\r\n}\r\n\r\nexports.removeSensor = (board_model_id, sensor_id) => {\r\n    return new Promise((resolve, reject) => {\r\n        db.Boardmodel.findById(board_model_id).then(\r\n            model => {\r\n                if (model) model.removeSensors(sensor_id).then(\r\n                    () => resolve(),\r\n                    error => reject(error));\r\n                else reject(new Error(\"board model not found\"));\r\n            }, error => reject(error));\r\n    });\r\n}","var business = require('../../business/index').v1_0_0;\r\n\r\n/**\r\n * @api {post} /boardmodel 01) Create Model\r\n * @apiGroup Board\r\n * @apiName createBoardModel\r\n * @apiDescription create a new board model.\r\n * @apiVersion 1.0.0\r\n * @apiUse box\r\n * \r\n * @apiPermission admin\r\n * @apiParam {string} name board model name\r\n * @apiParam {string} type board type, must be 'environmental', 'wearable' or 'non-wearable'\r\n * @apiParamExample {json} Request example:\r\n *     {\r\n *          \"name\": \"Zolertia RE-Mote\",\r\n *          \"type\": \"environmental\"\r\n *     }\r\n * @apiSuccess {string} id created board model id\r\n */\r\nexports.create = (req, res) => {\r\n    if (req.client.constructor.name === \"User\" && req.client.admin) {\r\n        business.boardmodel.create(req.body).then(\r\n            model => res.status(200).json({ id: model.id }),\r\n            error => res.status(500).send(error.message));\r\n    } else {\r\n        res.status(500).send(\"Unauthorized\" );\r\n    }\r\n}\r\n\r\n/**\r\n* @api {get} /boardmodel 02) List Models\r\n* @apiGroup Board\r\n* @apiName listsBoardsModel\r\n* @apiDescription list all board models. \r\n* @apiVersion 1.0.0\r\n* @apiUse box\r\n*\r\n* @apiPermission admin\r\n* @apiSuccess {array} models list of board models\r\n* @apiSuccess {string} id id of each board model\r\n* @apiSuccess {string} type type of the model (must be 'environmental', 'wearable' or 'non-wearable')\r\n* @apiSuccess {string} name name of the model\r\n* @apiSuccessExample {json} Response example:\r\n* {\r\n*  \"models\": [\r\n*      {\r\n*          \"id\": \"5d93585b-f511-4fa8-b69e-692c2474d5e8\",\r\n*          \"type\": \"non-wearable\",\r\n*          \"name\": \"MySignals\"\r\n*      },\r\n*      {\r\n*          \"id\": \"d4710130-4c8c-4ade-96c7-0d5c00738eda\",\r\n*          \"type\": \"environmental\",\r\n*          \"name\": \"Zolertia RE-Mote\"\r\n*      }\r\n*  ]\r\n* }\r\n*/\r\nexports.list = (req, res) => {\r\n    if (req.client.constructor.name === \"User\" && req.client.admin) {\r\n        business.boardmodel.list().then(\r\n            models => res.status(200).json({ models: models }),\r\n            error => res.status(500).send(error.message));\r\n    } else {\r\n        res.status(500).send(\"Unauthorized\");\r\n    }\r\n}\r\n\r\n/**\r\n * @api {put} /boardmodel/:id 03) Update Model\r\n * @apiGroup Board\r\n * @apiName updateBoardModel\r\n * @apiDescription update a board model.\r\n * @apiVersion 1.0.0\r\n * @apiUse box\r\n * \r\n * @apiPermission admin\r\n * @apiParam {string} :id board model id to update\r\n * @apiParam {string} name board model name\r\n * @apiParam {string} type board type, must be 'environmental', 'wearable' or 'non-wearable'\r\n * @apiParamExample {json} Request example:\r\n *     {\r\n *          \"name\": \"Zolertia RE-Mote\",\r\n *          \"type\": \"environmental\"\r\n *     }\r\n * @apiSuccess {boolean} result return \"true\" if was sucessfuly updated\r\n */\r\nexports.update = (req, res) => {\r\n    if (req.client.constructor.name === \"User\" && req.client.admin) {\r\n        business.boardmodel.update(req.params.id, req.body).then(\r\n            () => res.status(200).json({ result: true }),\r\n            error => res.status(500).send(error.message));\r\n    } else {\r\n        res.status(500).send(\"Unauthorized\");\r\n    }\r\n}\r\n\r\n/**\r\n * @api {delete} /boardmodel/:id 04) Delete Model\r\n * @apiGroup Board\r\n * @apiName deleteBoardModel\r\n * @apiDescription remove a board model.\r\n * @apiVersion 1.0.0\r\n * @apiUse box\r\n * \r\n * @apiPermission admin\r\n * @apiParam {string} :id board model id to delete\r\n * @apiSuccess {boolean} result return \"true\" if was sucessfuly removed\r\n */\r\nexports.delete = (req, res) => {\r\n    if (req.client.constructor.name === \"User\" && req.client.admin) {\r\n        business.boardmodel.remove(req.params.id).then(\r\n            () => res.status(200).json({ result: true }),\r\n            error => res.status(500).send(error.message));\r\n    } else {\r\n        res.status(500).send(\"Unauthorized\");\r\n    }\r\n}\r\n\r\n/**\r\n * @api {post} /boardmodel/:id/sensor 05) Add Sensor\r\n * @apiGroup Board\r\n * @apiName setSensors\r\n * @apiDescription add sensors to a board model\r\n * @apiVersion 1.0.0\r\n * @apiUse box\r\n * \r\n * @apiPermission admin\r\n * @apiParam {array} sensor_id sensors unique ID\r\n * @apiParamExample {json} Request example:\r\n * {\r\n *  \"sensor_id\": \"75a60f5f-ef3d-4556-9cdd-981894c8f1dc\"\r\n * }\r\n * @apiSuccess {boolean} result return true if was sucessfuly added\r\n */\r\nexports.setSensor = (req, res) => {\r\n    if (req.client.constructor.name === \"User\" && req.client.admin) {\r\n        business.boardmodel.setSensor(req.params.id, req.body.sensor_id).then(\r\n            () => res.status(200).json({ result: true }),\r\n            error => res.status(500).send(error.message));\r\n    } else {\r\n        res.status(500).send(\"Unauthorized\");\r\n    }\r\n}\r\n\r\n/**\r\n * @api {get} boardmodel/:id/sensor 06) Get Sensors\r\n * @apiGroup Board\r\n * @apiName getSensors\r\n * @apiDescription list sensors of a board model\r\n * @apiVersion 1.0.0\r\n * @apiUse box\r\n * \r\n * @apiPermission admin\r\n * @apiParam {string} :id board model unique ID\r\n * @apiSuccess {array} models list of sensors\r\n * @apiSuccess {string} transducer transducer name\r\n * @apiSuccess {string} measure transducer measure\r\n * @apiSuccess {decimal} min_acceptable minimum acceptable value to sensor\r\n * @apiSuccess {decimal} max_acceptable maximum acceptable value to sensor\r\n * @apiSuccess {decimal} min_possible minimum possible value to sensor\r\n * @apiSuccess {decimal} max_possible maximum possible value to sensor\r\n * @apiSuccessExample {json} Request example:\r\n * {\r\n *  \"sensors\": [\r\n *      {\r\n *           \"id\": \"e783b552-567f-499b-b480-9d373fe62a17\"\r\n *           \"transducer\": \"dht22\",\r\n *           \"measure\":\"temperature\",\r\n *           \"min_acceptable\": \"10\",\r\n *           \"max_acceptable\": \"25\",\r\n *           \"min_possible\": \"-20\",\r\n *           \"max_possible\": \"50\"\r\n *      }\r\n *  ]\r\n * }\r\n */\r\nexports.getSensors = (req, res) => {\r\n    if (req.client.constructor.name === \"User\" && req.client.admin) {\r\n        business.boardmodel.getSensors(req.params.id).then(\r\n            sensors => res.status(200).json({ sensors: sensors }),\r\n            error => res.status(500).send(error.message));\r\n    } else {\r\n        res.status(500).send(\"Unauthorized\");\r\n    }\r\n}\r\n\r\n/**\r\n * @api {delete} boardmodel/:id/sensor 07) Remove Sensor\r\n * @apiGroup Board\r\n * @apiName removeSensor\r\n * @apiDescription remove sensor from a board model \r\n * @apiVersion 1.0.0\r\n * @apiUse box\r\n * \r\n * @apiPermission admin\r\n * @apiParam {string} :id board model unique ID\r\n * @apiParam {string} sensor_id sensor to remove ID\r\n * @apiParamExample {json} Response example:\r\n * {\r\n *  \"sensor_id\": \"00397579-0a11-42ee-b522-b25e11630eda\"\r\n * }\r\n * @apiSuccess {boolean} result return true if was sucessfuly removed\r\n */\r\nexports.removeSensor = (req, res) => {\r\n    if (req.client.constructor.name === \"User\" && req.client.admin) {\r\n        business.boardmodel.removeSensor(req.params.id, req.body.sensor_id).then(\r\n            () => res.status(200).json({ result: true }),\r\n            error => res.status(500).send(error.message));\r\n    } else {\r\n        res.status(500).send(\"Unauthorized\");\r\n    }\r\n}","module.exports.v1_0_0 = {\r\n    'board_model': require('./v1.0.0/board_model'),\r\n    'board': require('./v1.0.0/board'),\r\n    'manage':require('./v1.0.0/manage'),\r\n    'record': require('./v1.0.0/record'),\r\n    'sensor':require('./v1.0.0/sensor'),\r\n    'user': require('./v1.0.0/user'),\r\n    'vitabox': require('./v1.0.0/vitabox'),\r\n}","// ROUTES FOR OUR API\r\n// =============================================================================\r\nmodule.exports = (app) => {\r\n\r\n    var controllers = require('./controllers/index'),\r\n        versioning = require('express-routes-versioning')();\r\n\r\n\r\n    app\r\n        /*________________________________________________check\r\n        *_____________________USERS_______________________\r\n        *_________________________________________________*/\r\n        .post('/register', versioning({\r\n            \"1.0.0\": controllers.v1_0_0.user.register,\r\n            \"2.0.0\": (req, res) => res.json({ error: 'invalid version' })\r\n        }))\r\n        .post('/login', versioning({\r\n            \"1.0.0\": controllers.v1_0_0.user.login,\r\n        }))\r\n        .post('/chpass', versioning({\r\n            \"1.0.0\": controllers.v1_0_0.user.changePassword,\r\n        }))\r\n        /*________________________________________________check\r\n        *____________________ VITABOX_____________________\r\n        *_________________________________________________*/\r\n        .post('/vitabox', versioning({\r\n            \"1.0.0\": controllers.v1_0_0.vitabox.create\r\n        }))\r\n        .get('/vitabox', versioning({\r\n            \"1.0.0\": controllers.v1_0_0.vitabox.list\r\n        }))\r\n        .get('/vitabox/:id', versioning({\r\n            \"1.0.0\": controllers.v1_0_0.vitabox.find\r\n        }))\r\n        .get('/settings/vitabox', versioning({\r\n            \"1.0.0\": controllers.v1_0_0.vitabox.getSettings\r\n        }))\r\n        .put('/settings/vitabox', versioning({\r\n            \"1.0.0\": controllers.v1_0_0.vitabox.setSettings\r\n        }))\r\n        .put('/vitabox/:id', versioning({\r\n            \"1.0.0\": controllers.v1_0_0.vitabox.update\r\n        }))\r\n        .delete('/vitabox/:id', versioning({\r\n            \"1.0.0\": controllers.v1_0_0.vitabox.delete\r\n        }))\r\n        .post('/vitabox/:id/register', versioning({\r\n            \"1.0.0\": controllers.v1_0_0.vitabox.register\r\n        }))\r\n        .post('/vitabox/:id/connect', versioning({\r\n            \"1.0.0\": controllers.v1_0_0.vitabox.connect\r\n        }))\r\n        .get('/vitabox/:id/user', versioning({\r\n            \"1.0.0\": controllers.v1_0_0.vitabox.getUsers\r\n        }))\r\n        .post('/vitabox/:id/user', versioning({\r\n            \"1.0.0\": controllers.v1_0_0.vitabox.addUser\r\n        }))\r\n        .delete('/vitabox/:id/user', versioning({\r\n            \"1.0.0\": controllers.v1_0_0.vitabox.removeUser\r\n        }))\r\n        .post('/vitabox/:id/patient', versioning({\r\n            \"1.0.0\": controllers.v1_0_0.vitabox.addPatient\r\n        }))\r\n        .get('/vitabox/:id/patient', versioning({\r\n            \"1.0.0\": controllers.v1_0_0.vitabox.getPatients\r\n        }))\r\n        .delete('/vitabox/:id/patient', versioning({\r\n            \"1.0.0\": controllers.v1_0_0.vitabox.removePatient\r\n        }))\r\n        .post('/vitabox/:id/board', versioning({\r\n            \"1.0.0\": controllers.v1_0_0.vitabox.addBoard\r\n        }))\r\n        .get('/vitabox/:id/board', versioning({\r\n            \"1.0.0\": controllers.v1_0_0.vitabox.getBoards\r\n        }))\r\n        .delete('/vitabox/:id/board', versioning({\r\n            \"1.0.0\": controllers.v1_0_0.vitabox.removeBoard\r\n        }))\r\n        /*________________________________________________check\r\n        *__________________ BOARD MODEL___________________\r\n        *_________________________________________________*/\r\n        .post('/boardmodel', versioning({\r\n            \"1.0.0\": controllers.v1_0_0.board_model.create\r\n        }))\r\n        .get('/boardmodel', versioning({\r\n            \"1.0.0\": controllers.v1_0_0.board_model.list\r\n        }))\r\n        .put('/boardmodel/:id', versioning({\r\n            \"1.0.0\": controllers.v1_0_0.board_model.update\r\n        }))\r\n        .delete('/boardmodel/:id', versioning({\r\n            \"1.0.0\": controllers.v1_0_0.board_model.delete\r\n        }))\r\n        .post('/boardmodel/:id/sensor', versioning({\r\n            \"1.0.0\": controllers.v1_0_0.board_model.setSensor\r\n        }))\r\n        .get('/boardmodel/:id/sensor', versioning({\r\n            \"1.0.0\": controllers.v1_0_0.board_model.getSensors\r\n        }))\r\n        .delete('/boardmodel/:id/sensor', versioning({\r\n            \"1.0.0\": controllers.v1_0_0.board_model.removeSensor\r\n        }))\r\n        /*________________________________________________check\r\n        *_____________________SENSOR______________________\r\n        *_________________________________________________*/\r\n        .post('/sensor', versioning({\r\n            \"1.0.0\": controllers.v1_0_0.sensor.create\r\n        }))\r\n        .get('/sensor', versioning({\r\n            \"1.0.0\": controllers.v1_0_0.sensor.list\r\n        }))\r\n        .put('/sensor/:id', versioning({\r\n            \"1.0.0\": controllers.v1_0_0.sensor.update\r\n        }))\r\n        .delete('/sensor/:id', versioning({\r\n            \"1.0.0\": controllers.v1_0_0.sensor.delete\r\n        }))\r\n        /*________________________________________________\r\n        *____________________RECORDS______________________\r\n        *_________________________________________________*/\r\n        .post('/record', versioning({\r\n            \"1.0.0\": controllers.v1_0_0.record.create\r\n        }))\r\n        .get('/record/patient/:id', versioning({\r\n            \"1.0.0\": controllers.v1_0_0.record.listByPatient\r\n        }))\r\n        .get('/record/board/:id', versioning({\r\n            \"1.0.0\": controllers.v1_0_0.record.listByBoard\r\n        }))\r\n        .get('/record/sensor/:id', versioning({\r\n            \"1.0.0\": controllers.v1_0_0.record.listBySensor\r\n        }))\r\n        /*________________________________________________\r\n        *_____________________TRASH_______________________\r\n        *_________________________________________________*/\r\n        .get('/destroy', versioning({\r\n            \"1.0.0\": controllers.v1_0_0.manage.destroyAll\r\n        }))\r\n        .get('/testdb', versioning({\r\n            \"1.0.0\": controllers.v1_0_0.manage.testDb\r\n        }))\r\n\r\n\r\n    app.all('*', (req, res) => {\r\n        res.status(404).json({ 'message': 'Route could not be found' });\r\n    });\r\n};","module.exports = require(\"path\");","module.exports = require(\"express\");","module.exports = require(\"os\");","module.exports = require(\"jsonwebtoken\");","module.exports = require(\"fs\");","module.exports = require(\"crypto\");","var mongoose = require('mongoose');\r\nvar schema = new mongoose.Schema({\r\n    value: {\r\n        type: Number,\r\n        required: true\r\n    },\r\n    datetime: {\r\n        type: Date,\r\n        default: Date.now()\r\n    },\r\n    patient_id: {\r\n        type: String,\r\n        required: false\r\n    },\r\n    board_id: {\r\n        type: String,\r\n        required: true\r\n    },\r\n    sensor_id: {\r\n        type: String,\r\n        required: true\r\n    },\r\n}, { versionKey: false });\r\n\r\nmodule.exports = mongoose.model('Record', schema);","'use strict';\r\nmodule.exports = (sequelize, DataTypes) => {\r\n  var Vitabox = sequelize.define('Vitabox', {\r\n    id: {\r\n      type: DataTypes.UUID,\r\n      defaultValue: DataTypes.UUIDV4,\r\n      primaryKey: true\r\n    },\r\n    password: {\r\n      type: DataTypes.STRING,\r\n      allowNull: false\r\n    },\r\n    latitude: {\r\n      type: DataTypes.DECIMAL(10, 7),\r\n      allowNull: true,\r\n      defaultValue: null,\r\n      validate: {\r\n        min: {\r\n          args: -90,\r\n          msg: \"latitude minimum acceptable value is -90\"\r\n        },\r\n        max: {\r\n          args: 90,\r\n          msg: \"latitude maximum acceptable value is 90\"\r\n        }\r\n      }\r\n    },\r\n    longitude: {\r\n      type: DataTypes.DECIMAL(10, 7),\r\n      allowNull: true,\r\n      defaultValue: null,\r\n      validate: {\r\n        min: {\r\n          args: -180,\r\n          msg: \"longitude minimum acceptable value is -180\"\r\n        },\r\n        max: {\r\n          args: 180,\r\n          msg: \"longitude maximum acceptable value is 180\"\r\n        }\r\n      }\r\n    },\r\n    settings: {\r\n      type: DataTypes.JSON,\r\n      allowNull: true,\r\n      defaultValue: null,\r\n    },\r\n    address: {\r\n      type: DataTypes.STRING,\r\n      defaultValue: null,\r\n      validate: {\r\n        notEmpty: {\r\n          args:true,\r\n          msg: \"address must be defined\"\r\n        }\r\n      }\r\n    },\r\n    registered: {\r\n      type: DataTypes.BOOLEAN,\r\n      defaultValue: false\r\n    },\r\n    active: {\r\n      type: DataTypes.BOOLEAN,\r\n      defaultValue: false\r\n    }\r\n  }, { underscored: true });\r\n\r\n  Vitabox.associate = function (models) {\r\n    models.Vitabox.belongsToMany(models.User, { through: models.UserVitabox });\r\n    models.Vitabox.hasMany(models.Patient);\r\n    models.Vitabox.hasMany(models.Board);\r\n  };\r\n\r\n  return Vitabox;\r\n};","'use strict';\r\nmodule.exports = (sequelize, DataTypes) => {\r\n    var User = sequelize.define('User', {\r\n        id: {\r\n            type: DataTypes.UUID,\r\n            defaultValue: DataTypes.UUIDV4,\r\n            primaryKey: true\r\n        },\r\n        email: {\r\n            type: DataTypes.STRING,\r\n            allowNull: false,\r\n            unique:{\r\n                args: true,\r\n                msg: 'email already registered'\r\n            },\r\n        },\r\n        password: {\r\n            type: DataTypes.STRING,\r\n            allowNull: false\r\n        },\r\n        admin: {\r\n            type: DataTypes.BOOLEAN,\r\n            defaultValue: false\r\n        }\r\n    }, {\r\n            scopes: {\r\n                profile: { attributes: { exclude: ['password'] } }\r\n            },\r\n            underscored: true\r\n        });\r\n\r\n    User.associate = function (models) {\r\n        models.User.belongsToMany(models.Vitabox, { through: models.UserVitabox });\r\n    };\r\n\r\n    return User;\r\n};","'use strict';\r\nmodule.exports = (sequelize, DataTypes) => {\r\n  var UserVitabox = sequelize.define('UserVitabox', {\r\n    sponsor: {\r\n        type: DataTypes.BOOLEAN,\r\n        defaultValue: false\r\n    }\r\n  }, { underscored: true });\r\n\r\n  return UserVitabox;\r\n};","'use strict';\r\nmodule.exports = (sequelize, DataTypes) => {\r\n    var Sensor = sequelize.define('Sensor', {\r\n        id: {\r\n            type: DataTypes.UUID,\r\n            defaultValue: DataTypes.UUIDV4,\r\n            primaryKey: true\r\n        },\r\n        transducer: {\r\n            type: DataTypes.STRING,\r\n            allowNull: false,\r\n            defaultValue: '',\r\n            validate: {\r\n                notEmpty: {\r\n                    msg: \"transducer name must be defined\"\r\n                }\r\n            }\r\n        },\r\n        measure: {\r\n            type: DataTypes.STRING,\r\n            allowNull: false,\r\n            defaultValue: '',\r\n            validate: {\r\n                notEmpty: {\r\n                    msg: \"transducer measure must be defined\"\r\n                }\r\n            }\r\n        },\r\n        min_acceptable: {\r\n            type: DataTypes.DECIMAL(10, 5),\r\n            allowNull: false,\r\n            validate: {\r\n                isDecimal: {\r\n                    args: true,\r\n                    msg: \"minimum acceptable value must be defined\"\r\n                }\r\n            }\r\n        },\r\n        max_acceptable: {\r\n            type: DataTypes.DECIMAL(10, 5),\r\n            allowNull: false,\r\n            validate: {\r\n                isDecimal: {\r\n                    args: true,\r\n                    msg: \"maximum acceptable value must be defined\"\r\n                }\r\n            }\r\n        },\r\n        min_possible: {\r\n            type: DataTypes.DECIMAL(10, 5),\r\n            allowNull: false,\r\n            validate: {\r\n                isDecimal: {\r\n                    args: true,\r\n                    msg: \"minimum possible value must be defined\"\r\n                }\r\n            }\r\n        },\r\n        max_possible: {\r\n            type: DataTypes.DECIMAL(10, 5),\r\n            validate: {\r\n                isDecimal: {\r\n                    args: true,\r\n                    msg: \"maximum possible value must be defined\"\r\n                }\r\n            }\r\n        }\r\n    }, { underscored: true });\r\n\r\n    Sensor.associate = function (models) {\r\n        models.Sensor.belongsToMany(models.Boardmodel, { through: \"BoardSensor\" });\r\n    };\r\n\r\n    return Sensor;\r\n};","'use strict';\r\nmodule.exports = (sequelize, DataTypes) => {\r\n    var Patient = sequelize.define('Patient', {\r\n        id: {\r\n            type: DataTypes.UUID,\r\n            defaultValue: DataTypes.UUIDV4,\r\n            primaryKey: true\r\n        },\r\n        birthdate: {\r\n            type: DataTypes.DATEONLY,\r\n            allowNull:false\r\n        },\r\n        name: {\r\n            type: DataTypes.STRING,\r\n            allowNull: false,\r\n            defaultValue: '',\r\n            validate: {\r\n                notEmpty: {\r\n                    msg: \"patient name must be defined\"\r\n                }\r\n            }\r\n        },\r\n        gender: {\r\n            type: DataTypes.ENUM,\r\n            values: ['undefined', 'male', 'female'],\r\n            defaultValue: 'undefined',\r\n            validate: {\r\n                isIn: {\r\n                    args: ['male', 'female', 'undefined'],\r\n                    msg: \"gender must be 'male', 'female' or 'undefined'\"\r\n                }\r\n            }\r\n        }\r\n    }, { underscored: true });\r\n\r\n    Patient.associate = function (models) {\r\n        models.Patient.belongsTo(models.Vitabox);\r\n    };\r\n\r\n    return Patient;\r\n};","'use strict';\r\nmodule.exports = (sequelize, DataTypes) => {\r\n    var Board = sequelize.define('Board', {\r\n        id: {\r\n            type: DataTypes.UUID,\r\n            defaultValue: DataTypes.UUIDV4,\r\n            primaryKey: true\r\n        },\r\n        location: {\r\n            type: DataTypes.STRING,\r\n            allowNull: true,\r\n            defaultValue: null\r\n        },\r\n        mac_address:{\r\n            type: DataTypes.STRING,\r\n            allowNull: false,\r\n            defaultValue: '',\r\n            validate: {\r\n                notEmpty: {\r\n                    msg: \"MAC address must be defined\"\r\n                }\r\n            }\r\n        }\r\n    }, { underscored: true });\r\n\r\n    Board.associate = function (models) {\r\n        models.Board.belongsTo(models.Vitabox);\r\n        models.Board.belongsTo(models.Boardmodel);\r\n    };\r\n\r\n    return Board;\r\n};","'use strict';\r\nmodule.exports = (sequelize, DataTypes) => {\r\n    var Boardmodel = sequelize.define('Boardmodel', {\r\n        id: {\r\n            type: DataTypes.UUID,\r\n            defaultValue: DataTypes.UUIDV4,\r\n            primaryKey: true\r\n        },\r\n        type: {\r\n            type: DataTypes.ENUM,\r\n            values: [\"environmental\", \"wearable\", \"non-wearable\"],\r\n            validate: {\r\n                isIn: {\r\n                    args: [[\"environmental\", \"wearable\", \"non-wearable\"]],\r\n                    msg: \"board type must be environmental, wearable or non-wearable\"\r\n                }\r\n            }\r\n        },\r\n        name: {\r\n            type: DataTypes.STRING,\r\n            unique: {\r\n                args: true,\r\n                msg: 'board model already registered'\r\n            },\r\n            allowNull: false,\r\n            defaultValue: '',\r\n            validate: {\r\n                notEmpty: {\r\n                    msg: \"board model must be defined\"\r\n                }\r\n            }\r\n        }\r\n    }, { underscored: true });\r\n\r\n    Boardmodel.associate = function (models) {\r\n        models.Boardmodel.hasMany(models.Board);\r\n        models.Boardmodel.belongsToMany(models.Sensor, { through: \"BoardSensor\" });\r\n    };\r\n\r\n    return Boardmodel;\r\n};","module.exports = require(\"sequelize\");","module.exports = require(\"dotenv\");","module.exports = require(\"cluster\");","// apidoc -i docs/ -f .js -o docs/\r\n\r\n// server.js\r\n\r\n// BASE SETUP\r\n// =============================================================================\r\nvar cluster = require('cluster');\r\n// Get the env variables from .env\r\nrequire('dotenv').config();\r\n\r\nif (cluster.isMaster) {\r\n    var db = require('./app/models/index');\r\n    db.sequelize.sync().then(\r\n        () => {\r\n            require('./app/models/seed').seed(db).then(\r\n                () => {\r\n                    console.log('\\x1b[32m%s\\x1b[0m.', '(PLAIN) Connection established with MongoDB and MySQL');\r\n\r\n                    var cpus = require('os').cpus().length\r\n                    console.log('Master cluster setting up ' + cpus + ' workers...');\r\n\r\n                    for (var i = 0; i < cpus; i++) {\r\n                        cluster.fork();\r\n                    }\r\n\r\n                    cluster.on('exit', function (worker, code, signal) {\r\n                        console.log('Worker ' + worker.process.pid + ' died with code: ' + code + ', and signal: ' + signal + '-> Starting a new worker');\r\n                        cluster.fork();\r\n                    });\r\n                },\r\n                error => {\r\n                    console.log('Unable to seed Databases.');\r\n                    console.log(error.message);\r\n                    process.exit(1);\r\n                }\r\n            )\r\n        },\r\n        error => {\r\n            console.log('Unable to connect to Databases.');\r\n            console.log(error);\r\n            process.exit(1);\r\n        });\r\n} else {\r\n    // call the packages we need\r\n    var express = require('express'),           // call express\r\n        // https = require('https'),\r\n        // fs = require(\"fs\"),\r\n        path = require('path'),\r\n        router = require('./app/router'),\r\n        bodyParser = require('body-parser'),\r\n        utils = require('./app/business/index').v1_0_0.utils;\r\n\r\n    // START THE SERVER\r\n    // =============================================================================\r\n    // define our app using express\r\n    var app = express();\r\n\r\n    // middleware to use for all requests\r\n    app.use(bodyParser.urlencoded({ extended: true }));\r\n    app.use(bodyParser.json());\r\n    app.use((req, res, next) => {\r\n        res.header(\"Access-Control-Allow-Origin\", \"*\");\r\n        res.header(\"Access-Control-Allow-Headers\", \"Origin, X-Requested-With, Content-Type, Accept, Authorization, Accept-Version\");\r\n        res.header(\"Access-Control-Allow-Methods\", \"POST, GET, PUT, DELETE, OPTIONS\");\r\n        res.header('Access-Control-Allow-Credentials', true);\r\n        if (process.env.NODE_ENV === \"development\") console.log(\"\\x1b[36m\" + req.method, req.url + \"\\x1b[0m\");\r\n       \r\n        if (req.method === \"OPTIONS\") {\r\n            return res.send(200);\r\n        } \r\n        if (req.headers && req.headers.authorization) {\r\n            utils.validateToken(req.headers.authorization, req.connection.remoteAddress).then(\r\n                client => {\r\n                    if (client) {\r\n                        req.client = client;\r\n                        next();\r\n                    } else res.status(500).send(\"Client not registered\");\r\n                },\r\n                error => res.status(500).send(error.message));\r\n        } else {\r\n            req.user = undefined;\r\n            next(); // make sure that proceeds to the next routes and don't stop here\r\n        }\r\n    });\r\n\r\n    // Present SPA\r\n    app.use('/', express.static(path.resolve(__dirname, 'public')));\r\n    // Present Documentation\r\n    app.use('/docs', express.static(path.resolve(__dirname, 'docs')));\r\n    // REGISTER ROUTES -------------------------------\r\n    router(app);\r\n\r\n    // Define the listenning port\r\n    var port = process.env.PORT || 8080;\r\n    // start http server\r\n    app.listen(port, () => {\r\n        // https://stackoverflow.com/questions/9781218/how-to-change-node-jss-console-font-color\r\n        console.log('\\x1b[32m%s %d\\x1b[0m.', '(PLAIN) Server http listening on port', port);\r\n    });\r\n\r\n    // //set options to https\r\n    // const options = {\r\n    //     key: fs.readFileSync(__dirname + \"/app/keys/https_key.pem\"),\r\n    //     cert: fs.readFileSync(__dirname + \"/app/keys/https_cert.pem\"),\r\n    //     ca: fs.readFileSync(__dirname + \"/app/keys/https_ca.pem\"),\r\n    //     dhparam: fs.readFileSync(__dirname + \"/app/keys/https_dhparam.pem\")\r\n    // };\r\n    // // start https server\r\n    // https.createServer(options, app).listen(8080, () => {\r\n    //     console.log('\\x1b[32m%s %d\\x1b[0m.', '(PLAIN) Server https listening on port', port);\r\n    // });\r\n}"],"sourceRoot":""}